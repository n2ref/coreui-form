!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):((t="undefined"!=typeof globalThis?globalThis:t||self).CoreUI=t.CoreUI||{},t.CoreUI.form=e())}(this,function(){"use strict";function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).ejs=t()}(function(){return function n(o,s,r){function a(e,t){if(!s[e]){if(!o[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(l)return l(e,!0);throw(t=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",t}i=s[e]={exports:{}},o[e][0].call(i.exports,function(t){return a(o[e][1][t]||t)},i,i.exports,n,o,s,r)}return s[e].exports}for(var l="function"==typeof require&&require,t=0;t<r.length;t++)a(r[t]);return a}({1:[function(t,e,l){var s=t("fs"),h=t("path"),u=t("./utils"),i=!1,t=t("../package.json").version,n="locals",o=["delimiter","scope","context","debug","compileDebug","client","_with","rmWhitespace","strict","filename","async"],d=o.concat("cache"),r=/^\uFEFF/,c=/^[a-zA-Z_$][0-9a-zA-Z_$]*$/;function a(e,t){var i;if(t.some(function(t){return i=l.resolveInclude(e,t,!0),s.existsSync(i)}))return i}function f(t,e){var i,n=t.filename,o=1<arguments.length;if(t.cache){if(!n)throw new Error("cache option requires a filename");if(i=l.cache.get(n))return i;o||(e=p(n).toString().replace(r,""))}else if(!o){if(!n)throw new Error("Internal EJS error: no file name or template provided");e=p(n).toString().replace(r,"")}return i=l.compile(e,t),t.cache&&l.cache.set(n,i),i}function p(t){return l.fileLoader(t)}function _(t,e){var i=u.shallowCopy(u.createNullProtoObjWherePossible(),e);if(i.filename=function(t,e){var i,n=e.views,o=/^[A-Za-z]+:\\|^\//.exec(t);if(o&&o.length)t=t.replace(/^\/*/,""),i=Array.isArray(e.root)?a(t,e.root):l.resolveInclude(t,e.root||"/",!0);else if(!(i=!(i=e.filename&&(o=l.resolveInclude(t,e.filename),s.existsSync(o))?o:i)&&Array.isArray(n)?a(t,n):i)&&"function"!=typeof e.includer)throw new Error('Could not find the include file "'+e.escapeFunction(t)+'"');return i}(t,i),"function"==typeof e.includer){e=e.includer(t,i.filename);if(e&&(e.filename&&(i.filename=e.filename),e.template))return f(i,e.template)}return f(i)}function m(t,e,i,n,o){var e=e.split("\n"),s=Math.max(n-3,0),r=Math.min(e.length,n+3),o=o(i),i=e.slice(s,r).map(function(t,e){e=e+s+1;return(e==n?" >> ":"    ")+e+"| "+t}).join("\n");throw t.path=o,t.message=(o||"ejs")+":"+n+"\n"+i+"\n\n"+t.message,t}function v(t){return t.replace(/;(\s*$)/,"$1")}function g(t,e){e=e||u.createNullProtoObjWherePossible();var i=u.createNullProtoObjWherePossible();this.templateText=t,this.mode=null,this.truncate=!1,this.currentLine=1,this.source="",i.client=e.client||!1,i.escapeFunction=e.escape||e.escapeFunction||u.escapeXML,i.compileDebug=!1!==e.compileDebug,i.debug=!!e.debug,i.filename=e.filename,i.openDelimiter=e.openDelimiter||l.openDelimiter||"<",i.closeDelimiter=e.closeDelimiter||l.closeDelimiter||">",i.delimiter=e.delimiter||l.delimiter||"%",i.strict=e.strict||!1,i.context=e.context,i.cache=e.cache||!1,i.rmWhitespace=e.rmWhitespace,i.root=e.root,i.includer=e.includer,i.outputFunctionName=e.outputFunctionName,i.localsName=e.localsName||l.localsName||n,i.views=e.views,i.async=e.async,i.destructuredLocals=e.destructuredLocals,i.legacyInclude=void 0===e.legacyInclude||!!e.legacyInclude,i.strict?i._with=!1:i._with=void 0===e._with||e._with,this.opts=i,this.regex=this.createRegex()}l.cache=u.cache,l.fileLoader=s.readFileSync,l.localsName=n,l.promiseImpl=new Function("return this;")().Promise,l.resolveInclude=function(t,e,i){var n=h.dirname,o=h.extname,i=(0,h.resolve)(i?e:n(e),t);return o(t)||(i+=".ejs"),i},l.compile=function(t,e){return e&&e.scope&&(i||(console.warn("`scope` option is deprecated and will be removed in EJS 3"),i=!0),e.context||(e.context=e.scope),delete e.scope),new g(t,e).compile()},l.render=function(t,e,i){e=e||u.createNullProtoObjWherePossible(),i=i||u.createNullProtoObjWherePossible();return 2==arguments.length&&u.shallowCopyFromList(i,e,o),f(i,t)(e)},l.renderFile=function(){var t,e,i,n=Array.prototype.slice.call(arguments),o=n.shift(),s={filename:o},r=("function"==typeof arguments[arguments.length-1]&&(t=n.pop()),n.length?(e=n.shift(),n.length?u.shallowCopy(s,n.pop()):(e.settings&&(e.settings.views&&(s.views=e.settings.views),e.settings["view cache"]&&(s.cache=!0),n=e.settings["view options"])&&u.shallowCopy(s,n),u.shallowCopyFromList(s,e,d)),s.filename=o):e=u.createNullProtoObjWherePossible(),s),a=e,n=t;if(!n){if("function"==typeof l.promiseImpl)return new l.promiseImpl(function(t,e){try{t(i=f(r)(a))}catch(t){e(t)}});throw new Error("Please provide a callback function")}try{i=f(r)(a)}catch(t){return n(t)}n(null,i)},l.Template=g,l.clearCache=function(){l.cache.reset()},g.modes={EVAL:"eval",ESCAPED:"escaped",RAW:"raw",COMMENT:"comment",LITERAL:"literal"},g.prototype={createRegex:function(){var t="(<%%|%%>|<%=|<%-|<%_|<%#|<%|%>|-%>|_%>)",e=u.escapeRegExpChars(this.opts.delimiter),i=u.escapeRegExpChars(this.opts.openDelimiter),n=u.escapeRegExpChars(this.opts.closeDelimiter),t=t.replace(/%/g,e).replace(/</g,i).replace(/>/g,n);return new RegExp(t)},compile:function(){var t,o=this.opts,e="",i="",s=o.escapeFunction,n=o.filename?JSON.stringify(o.filename):"undefined";if(!this.source){if(this.generateSource(),e+='  var __output = "";\n  function __append(s) { if (s !== undefined && s !== null) __output += s }\n',o.outputFunctionName){if(!c.test(o.outputFunctionName))throw new Error("outputFunctionName is not a valid JS identifier.");e+="  var "+o.outputFunctionName+" = __append;\n"}if(o.localsName&&!c.test(o.localsName))throw new Error("localsName is not a valid JS identifier.");if(o.destructuredLocals&&o.destructuredLocals.length){for(var r="  var __locals = ("+o.localsName+" || {}),\n",a=0;a<o.destructuredLocals.length;a++){var l=o.destructuredLocals[a];if(!c.test(l))throw new Error("destructuredLocals["+a+"] is not a valid JS identifier.");0<a&&(r+=",\n  "),r+=l+" = __locals."+l}e+=r+";\n"}!1!==o._with&&(e+="  with ("+o.localsName+" || {}) {\n",i+="  }\n"),this.source=e+this.source+(i+="  return __output;\n")}e=o.compileDebug?"var __line = 1\n  , __lines = "+JSON.stringify(this.templateText)+"\n  , __filename = "+n+";\ntry {\n"+this.source+"} catch (e) {\n  rethrow(e, __lines, __filename, __line, escapeFn);\n}\n":this.source,o.client&&(e="escapeFn = escapeFn || "+s.toString()+";\n"+e,o.compileDebug)&&(e="rethrow = rethrow || "+m.toString()+";\n"+e),o.strict&&(e='"use strict";\n'+e),o.debug&&console.log(e),o.compileDebug&&o.filename&&(e=e+"\n//# sourceURL="+n+"\n");try{if(o.async)try{d=new Function("return (async function(){}).constructor;")()}catch(t){throw t instanceof SyntaxError?new Error("This environment does not support async/await"):t}else d=Function;t=new d(o.localsName+", escapeFn, include, rethrow",e)}catch(t){throw t instanceof SyntaxError&&(o.filename&&(t.message+=" in "+o.filename),t.message+=" while compiling ejs\n\n",t.message+="If the above error is not helpful, you may want to try EJS-Lint:\n",t.message+="https://github.com/RyanZim/EJS-Lint",o.async||(t.message+="\n",t.message+="Or, if you meant to create an async function, pass `async: true` as an option.")),t}i=o.client?t:function(n){return t.apply(o.context,[n||u.createNullProtoObjWherePossible(),s,function(t,e){var i=u.shallowCopy(u.createNullProtoObjWherePossible(),n);return e&&(i=u.shallowCopy(i,e)),_(t,o)(i)},m])};if(o.filename&&"function"==typeof Object.defineProperty){var n=o.filename,d=h.basename(n,h.extname(n));try{Object.defineProperty(i,"name",{value:d,writable:!1,enumerable:!1,configurable:!0})}catch(t){}}return i},generateSource:function(){this.opts.rmWhitespace&&(this.templateText=this.templateText.replace(/[\r\n]+/g,"\n").replace(/^\s+|\s+$/gm,"")),this.templateText=this.templateText.replace(/[ \t]*<%_/gm,"<%_").replace(/_%>[ \t]*/gm,"_%>");var i=this,n=this.parseTemplateText(),o=this.opts.delimiter,s=this.opts.openDelimiter,r=this.opts.closeDelimiter;n&&n.length&&n.forEach(function(t,e){if(0===t.indexOf(s+o)&&0!==t.indexOf(s+o+o)&&(e=n[e+2])!=o+r&&e!="-"+o+r&&e!="_"+o+r)throw new Error('Could not find matching close tag for "'+t+'".');i.scanLine(t)})},parseTemplateText:function(){for(var t,e=this.templateText,i=this.regex,n=i.exec(e),o=[];n;)0!==(t=n.index)&&(o.push(e.substring(0,t)),e=e.slice(t)),o.push(n[0]),e=e.slice(n[0].length),n=i.exec(e);return e&&o.push(e),o},_addOutput:function(t){if(this.truncate&&(t=t.replace(/^(?:\r\n|\r|\n)/,""),this.truncate=!1),!t)return t;t=(t=(t=(t=t.replace(/\\/g,"\\\\")).replace(/\n/g,"\\n")).replace(/\r/g,"\\r")).replace(/"/g,'\\"'),this.source+='    ; __append("'+t+'")\n'},scanLine:function(t){var e=this.opts.delimiter,i=this.opts.openDelimiter,n=this.opts.closeDelimiter,o=t.split("\n").length-1;switch(t){case i+e:case i+e+"_":this.mode=g.modes.EVAL;break;case i+e+"=":this.mode=g.modes.ESCAPED;break;case i+e+"-":this.mode=g.modes.RAW;break;case i+e+"#":this.mode=g.modes.COMMENT;break;case i+e+e:this.mode=g.modes.LITERAL,this.source+='    ; __append("'+t.replace(i+e+e,i+e)+'")\n';break;case e+e+n:this.mode=g.modes.LITERAL,this.source+='    ; __append("'+t.replace(e+e+n,e+n)+'")\n';break;case e+n:case"-"+e+n:case"_"+e+n:this.mode==g.modes.LITERAL&&this._addOutput(t),this.mode=null,this.truncate=0===t.indexOf("-")||0===t.indexOf("_");break;default:if(this.mode){switch(this.mode){case g.modes.EVAL:case g.modes.ESCAPED:case g.modes.RAW:t.lastIndexOf("//")>t.lastIndexOf("\n")&&(t+="\n")}switch(this.mode){case g.modes.EVAL:this.source+="    ; "+t+"\n";break;case g.modes.ESCAPED:this.source+="    ; __append(escapeFn("+v(t)+"))\n";break;case g.modes.RAW:this.source+="    ; __append("+v(t)+")\n";break;case g.modes.COMMENT:break;case g.modes.LITERAL:this._addOutput(t)}}else this._addOutput(t)}this.opts.compileDebug&&o&&(this.currentLine+=o,this.source+="    ; __line = "+this.currentLine+"\n")}},l.escapeXML=u.escapeXML,l.__express=l.renderFile,l.VERSION=t,l.name="ejs","undefined"!=typeof window&&(window.ejs=l)},{"../package.json":6,"./utils":2,fs:3,path:4}],2:[function(t,e,i){function s(t,e){return o.apply(t,[e])}var n=/[|\\{}()[\]^$+*?.]/g,o=Object.prototype.hasOwnProperty,r=(i.escapeRegExpChars=function(t){return t?String(t).replace(n,"\\$&"):""},{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"}),a=/[&<>'"]/g;function l(t){return r[t]||t}function d(){return Function.prototype.toString.call(this)+';\nvar _ENCODE_HTML_RULES = {\n      "&": "&amp;"\n    , "<": "&lt;"\n    , ">": "&gt;"\n    , \'"\': "&#34;"\n    , "\'": "&#39;"\n    }\n  , _MATCH_HTML = /[&<>\'"]/g;\nfunction encode_char(c) {\n  return _ENCODE_HTML_RULES[c] || c;\n};\n'}i.escapeXML=function(t){return null==t?"":String(t).replace(a,l)};try{"function"==typeof Object.defineProperty?Object.defineProperty(i.escapeXML,"toString",{value:d}):i.escapeXML.toString=d}catch(t){console.warn("Unable to set escapeXML.toString (is the Function prototype frozen?)")}i.shallowCopy=function(t,e){if(e=e||{},null!=t)for(var i in e)s(e,i)&&"__proto__"!==i&&"constructor"!==i&&(t[i]=e[i]);return t},i.shallowCopyFromList=function(t,e,i){if(i=i||[],e=e||{},null!=t)for(var n=0;n<i.length;n++){var o=i[n];void 0!==e[o]&&s(e,o)&&"__proto__"!==o&&"constructor"!==o&&(t[o]=e[o])}return t},i.cache={_data:{},set:function(t,e){this._data[t]=e},get:function(t){return this._data[t]},remove:function(t){delete this._data[t]},reset:function(){this._data={}}},i.hyphenToCamel=function(t){return t.replace(/-[a-z]/g,function(t){return t[1].toUpperCase()})},i.createNullProtoObjWherePossible="function"==typeof Object.create?function(){return Object.create(null)}:{__proto__:null}instanceof Object?function(){return{}}:function(){return{__proto__:null}}},{}],3:[function(t,e,i){},{}],4:[function(t,e,d){!function(o){function s(t,e){for(var i=0,n=t.length-1;0<=n;n--){var o=t[n];"."===o?t.splice(n,1):".."===o?(t.splice(n,1),i++):i&&(t.splice(n,1),i--)}if(e)for(;i--;)t.unshift("..");return t}function r(t,e){if(t.filter)return t.filter(e);for(var i=[],n=0;n<t.length;n++)e(t[n],n,t)&&i.push(t[n]);return i}d.resolve=function(){for(var t="",e=!1,i=arguments.length-1;-1<=i&&!e;i--){var n=0<=i?arguments[i]:o.cwd();if("string"!=typeof n)throw new TypeError("Arguments to path.resolve must be strings");n&&(t=n+"/"+t,e="/"===n.charAt(0))}return(e?"/":"")+(t=s(r(t.split("/"),function(t){return!!t}),!e).join("/"))||"."},d.normalize=function(t){var e=d.isAbsolute(t),i="/"===n(t,-1);return(t=(t=s(r(t.split("/"),function(t){return!!t}),!e).join("/"))||e?t:".")&&i&&(t+="/"),(e?"/":"")+t},d.isAbsolute=function(t){return"/"===t.charAt(0)},d.join=function(){var t=Array.prototype.slice.call(arguments,0);return d.normalize(r(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},d.relative=function(t,e){function i(t){for(var e=0;e<t.length&&""===t[e];e++);for(var i=t.length-1;0<=i&&""===t[i];i--);return i<e?[]:t.slice(e,i-e+1)}t=d.resolve(t).substr(1),e=d.resolve(e).substr(1);for(var n=i(t.split("/")),o=i(e.split("/")),s=Math.min(n.length,o.length),r=s,a=0;a<s;a++)if(n[a]!==o[a]){r=a;break}for(var l=[],a=r;a<n.length;a++)l.push("..");return(l=l.concat(o.slice(r))).join("/")},d.sep="/",d.delimiter=":",d.dirname=function(t){if("string"!=typeof t&&(t+=""),0===t.length)return".";for(var e=47===t.charCodeAt(0),i=-1,n=!0,o=t.length-1;1<=o;--o)if(47===t.charCodeAt(o)){if(!n){i=o;break}}else n=!1;return-1===i?e?"/":".":e&&1===i?"/":t.slice(0,i)},d.basename=function(t,e){t=function(t){"string"!=typeof t&&(t+="");for(var e=0,i=-1,n=!0,o=t.length-1;0<=o;--o)if(47===t.charCodeAt(o)){if(!n){e=o+1;break}}else-1===i&&(n=!1,i=o+1);return-1===i?"":t.slice(e,i)}(t);return t=e&&t.substr(-1*e.length)===e?t.substr(0,t.length-e.length):t},d.extname=function(t){"string"!=typeof t&&(t+="");for(var e=-1,i=0,n=-1,o=!0,s=0,r=t.length-1;0<=r;--r){var a=t.charCodeAt(r);if(47===a){if(o)continue;i=r+1;break}-1===n&&(o=!1,n=r+1),46===a?-1===e?e=r:1!==s&&(s=1):-1!==e&&(s=-1)}return-1===e||-1===n||0===s||1===s&&e===n-1&&e===i+1?"":t.slice(e,n)};var n="b"==="ab".substr(-1)?function(t,e,i){return t.substr(e,i)}:function(t,e,i){return e<0&&(e=t.length+e),t.substr(e,i)}}.call(this,t("_process"))},{_process:5}],5:[function(t,e,i){var n,o,e=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}try{n="function"==typeof setTimeout?setTimeout:s}catch(t){n=s}try{o="function"==typeof clearTimeout?clearTimeout:r}catch(t){o=r}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===s||!n)&&setTimeout)return(n=setTimeout)(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}var l,d=[],h=!1,u=-1;function c(){h&&l&&(h=!1,l.length?d=l.concat(d):u=-1,d.length)&&f()}function f(){if(!h){for(var t=a(c),e=(h=!0,d.length);e;){for(l=d,d=[];++u<e;)l&&l[u].run();u=-1,e=d.length}l=null,h=!1,!function(e){if(o===clearTimeout)return clearTimeout(e);if((o===r||!o)&&clearTimeout)return(o=clearTimeout)(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function _(){}e.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];d.push(new p(t,e)),1!==d.length||h||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=_,e.addListener=_,e.once=_,e.off=_,e.removeListener=_,e.removeAllListeners=_,e.emit=_,e.prependListener=_,e.prependOnceListener=_,e.listeners=function(t){return[]},e.binding=function(t){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(t){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},{}],6:[function(t,e,i){e.exports={name:"ejs",description:"Embedded JavaScript templates",keywords:["template","engine","ejs"],version:"3.1.8",author:"Matthew Eernisse <mde@fleegix.org> (http://fleegix.org)",license:"Apache-2.0",bin:{ejs:"./bin/cli.js"},main:"./lib/ejs.js",jsdelivr:"ejs.min.js",unpkg:"ejs.min.js",repository:{type:"git",url:"git://github.com/mde/ejs.git"},bugs:"https://github.com/mde/ejs/issues",homepage:"https://github.com/mde/ejs",dependencies:{jake:"^10.8.5"},devDependencies:{browserify:"^16.5.1",eslint:"^6.8.0","git-directory-deploy":"^1.5.1",jsdoc:"^4.0.2","lru-cache":"^4.0.1",mocha:"^10.2.0","uglify-js":"^3.3.16"},engines:{node:">=0.10.0"},scripts:{test:"mocha -u tdd"}}},{}]},{},[1])(1)});var f=Object.create(null);f["form-control.html"]=' <div id="coreui-form-<%= form.id %>-control-<%= control.index %>" class="coreui-form__control_container" <% if ( ! control.show) { %>style="display:none"<% } %>> <%- control.content %> </div>',f["form-error.html"]='<div class="coreui-form__error alert alert-danger alert-dismissible fade show mb-3 <%= options.class %>"> <%- message %> <% if (options.dismiss) { %> <button type="button" class="btn-close" data-bs-dismiss="alert"></button> <% } %> </div>',f["form-field-content.html"]="<%- content %>",f["form-field-group.html"]='<div id="coreui-form-<%= id %>" class="coreui-form__group_container mb-3"> <div class="coreui-form__group_label pe-2"> <h6 class="coreui-form__field_label_text col-form-label"> <%- group.label %> <% if (group.showCollapsible) { %> <button type="button" class="btn btn-link btn-collapsible text-dark"> <% if ( ! group.show) { %> <i class="bi bi-chevron-right"></i> <% } else { %> <i class="bi bi-chevron-down"></i> <% } %> </button> <% } %> </h6> </div> <div class="coreui-form__group_content"<% if ( ! group.show) { %> style="display:none"<% } %>></div> </div>',f["form-field-label.html"]='<div id="coreui-form-<%= id %>" class="coreui-form__field_container d-flex flex-column flex-md-row mb-3" <% if ( ! field.show) { %> style="display:none"<% } %>> <% if (field.labelWidth !== 0 && field.labelWidth !== \'0px\') { %> <div class="coreui-form__field_label text-md-end text-sm-start pe-2"<% if (field.labelWidth) { %> style="min-width:<%= field.labelWidth %>;width:<%= field.labelWidth %>"<% } %>> <div class="coreui-form__field_label_content col-form-label"> <% if (field.required) { %> <span class="coreui-form__field_label_req text-danger">*</span> <% } %> <span class="coreui-form__field_label_text fw-medium"><%- field.label %></span> </div> <% if (field.description) { %> <div class="coreui-form__field_label_description text-muted"> <small><%- field.description %></small> </div> <% } %> </div> <% } %> <div class="coreui-form__field_content flex-fill"> <div class="d-inline-block content-<%= hash %>"> <%- content %> </div> <% if (field.outContent) { %> <span class="coreui-form__field-content-out d-inline-block align-top ps-1"> <%- field.outContent %> </span> <% } %> <% if (attachFields && attachFields.length > 0) { %> <% $.each(attachFields, function(key, attachField) { %> <div class="<% if (attachField.hasOwnProperty(\'direction\') && attachField.direction === \'column\') { %>d-block mt-2<% } else { %>d-inline-block<% } %> content-<%= attachField.hash %>"> <%- attachField.content %> </div> <% }); %> <% } %> </div> </div>',f["form.html"]='<div id="coreui-form-<%= form.id %>" class="coreui-form mb-2" <% if (widthSizes) { %>style="<%= widthSizes.join(\';\') %>"<% } %>> <% if (form.title) { %> <h5 class="mb-4"><%- form.title %></h5> <% } %> <form action="<%= form.send.url %>" method="<%= form.send.method %>"<%- formAttr %>> <div class="coreui-form__fields d-flex justify-content-start flex-column flex-wrap"></div> <% if (controls) { %> <div class="coreui-form__controls d-flex justify-content-start flex-sm-wrap flex-md-nowrap"> <% if (form.controlsOffset !== 0 && form.controlsOffset !== \'0px\') { %> <div class="d-none d-md-block" style="width:<%= form.controlsOffset %>;min-width:<%= form.controlsOffset %>"></div> <% } %> <div class="d-flex justify-content-start flex-wrap gap-2"> <% $.each(controls, function(key, control) { %> <div id="coreui-form-<%= form.id %>-control-<%= control.index %>" class="coreui-form__control_container" <% if ( ! control.show) { %>style="display:none"<% } %>> </div> <% }); %> </div> </div> <% } %> </form> </div>',f["controls/button.html"]="<button <%- render.attr %>><%- control.content %></button>",f["controls/link.html"]='<a href="<%- control.url %>"<%- render.attr %>><%- control.content %></a>',f["fields/checkbox.html"]='<% if (field.readonly) { %> <div class="coreui-form__field-readonly col-form-label"><%- render.selectedItems.join(\', \') %></div> <% } else { %> <div class="pt-2"> <% $.each(render.options, function(key, option) { %> <div class="form-check<% if (field.inline) { %> form-check-inline<% } %>"> <input <%- option.attr %>/> <label class="form-check-label" for="<%= option.id %>"><%= option.text %></label> </div> <% }); %> </div> <% } %>',f["fields/color.html"]='<% if (field.readonly) { %> <div class="coreui-form__field-readonly col-form-label rounded-1" style="width: 14px;height: 14px;background-color: <%= value %>"></div> <% } else { %> <input <%- render.attr %>/> <% if (render.datalist.length > 0) { %> <datalist id="<%= datalistId %>"> <% $.each(render.datalist, function(key, item) { %> <option <%- item.attr %>/> <% }); %> </datalist> <% } %> <% } %>',f["fields/dataset-row-readonly.html"]='<tr class="coreui-form__field-dataset-item"> <% $.each(options, function(key, option) { %> <td class="pe-2 pb-1"> <%- option.value %> </td> <% }); %> </tr>',f["fields/dataset-row.html"]='<tr class="coreui-form__field-dataset-item" id="dataset-item-<%= hashItem %>"> <% $.each(options, function(key, option) { %> <td class="pe-1 pb-1"> <% if (option.type === \'select\') { %> <select <%- option.attr %>> <% $.each(option.items, function(key, item) { %> <option <%- item.attr %>><%- item.text %></option> <% }); %> </select> <% } else if (option.type === \'switch\') { %> <div class="form-check form-switch"> <input <%- option.attr %>/> </div> <% } else { %> <input <%- option.attr %>> <% } %> </td> <% }); %> <td class="pb-1"> <button type="button" class="btn btn-link btn-dataset-remove" data-item-id="dataset-item-<%= hashItem %>"> <i class="bi bi-x text-muted"></i> </button> </td> </tr>',f["fields/dataset.html"]='<% if (field.readonly) { %> <table class="coreui-form__field-dataset-container" <% if (render.rows.length == 0) { %> style="display:none"<% } %>> <thead> <tr> <% $.each(render.headers, function(key, item) { %> <td class="text-muted pe-2"><small><%= item.title %></small></td> <% }); %> </tr> </thead> <tbody class="coreui-form__field-dataset-list"> <% $.each(render.rows, function(key, row) { %> <%- row %> <% }); %> </tbody> </table> <% } else { %> <table class="coreui-form__field-dataset-container" <% if (render.rows.length == 0) { %> style="display:none"<% } %>> <thead> <tr> <% $.each(render.headers, function(key, item) { %> <td class="text-muted"><small><%= item.title %></small></td> <% }); %> <td></td> </tr> </thead> <tbody class="coreui-form__field-dataset-list"> <% $.each(render.rows, function(key, row) { %> <%- row %> <% }); %> </tbody> </table> <button type="button" class="btn btn-link btn-dataset-add"><%= lang.dataset_add %></button> <% } %>',f["fields/file-upload.html"]=' <% if (showButton) { %> <button type="button" class="btn btn-outline-secondary fileup-btn"> <%= lang.file_upload_select %> <input type="file" id="fileup-<%= id %>"<% if (isMultiple) { %> multiple<% } %><% if (accept) { %> accept="<%= accept %>"<% } %>> </button> <% } else { %> <input type="file" id="fileup-<%= id %>"<% if (isMultiple) { %> multiple<% } %><% if (accept) { %> accept="<%= accept %>"<% } %> style="display:none"> <% } %> <% if (showDropzone) { %> <div id="fileup-<%= id %>-dropzone" class="fileup-dropzone p-4 d-inline-block text-primary-emphasis fs-5 rounded-4 text-center <% if (showButton) { %>mt-2<% } %>>"> <i class="bi bi-folder2-open"></i> <%= lang.file_upload_dropzone %> </div> <% } %> <div id="fileup-<%= id %>-queue"></div>',f["fields/hidden.html"]="<% if ( ! field.readonly) { %> <input <%- render.attr %>/> <% } %>",f["fields/input.html"]='<% if (field.readonly) { %> <div class="coreui-form__field-readonly col-form-label"><%- value %></div> <% } else { %> <input <%- render.attr %>/> <% if (render.datalist.length > 0) { %> <datalist id="<%= datalistId %>"> <% $.each(render.datalist, function(key, item) { %> <option <%- item.attr %>/> <% }); %> </datalist> <% } %> <% } %>',f["fields/modal-loading.html"]='<div class="py-4 d-flex justify-content-center align-items-center gap-2"> <div class="spinner-border mr-2"></div> <%= lang.modal_loading %> </div> ',f["fields/modal.html"]='<% if (field.readonly) { %> <div class="coreui-form__field-readonly col-form-label"><%= text %></div> <% } else { %> <div class="input-group"<% if (render.width) { %> style="width:<%= render.width %>"<% } %>> <input <%- render.attr %>/> <input type="hidden" name="<%= field.name %>" value="<%= value %>" class="coreui-form-modal-value"/> <% if ( ! field.required) { %> <button class="btn btn-outline-secondary btn-modal-clear border-secondary-subtle" type="button"> <i class="bi bi-x"></i> </button> <% } %> <button class="btn btn-outline-secondary btn-modal-select border-secondary-subtle" type="button"><%= lang.modal_select %></button> </div> <% } %>',f["fields/passwordRepeat.html"]='<% if (field.readonly) { %> <div class="coreui-form__field-readonly col-form-label"><%- value %></div> <% } else { %> <div class="d-flex gap-1 align-items-center"> <input <%- render.attr %>/> <% if (field.showBtn) { %> <div class="input-group flex-nowrap"> <input <%- render.attr2 %>/> <button class="btn btn-outline-secondary border-secondary-subtle btn-password-change" type="button" data-change="<%- lang.change %>" data-cancel="<%- lang.cancel %>"><%= btn_text %></button> </div> <% } else { %> <input <%- render.attr2 %>/> <% } %> </div> <% } %>',f["fields/radio.html"]='<% if (field.readonly) { %> <div class="coreui-form__field-readonly col-form-label"><%- render.selectedItem %></div> <% } else { %> <div class="pt-2"> <% $.each(render.options, function(key, option) { %> <div class="form-check<% if (field.inline) { %> form-check-inline<% } %>"> <input <%- option.attr %>/> <label class="form-check-label" for="<%= option.id %>"><%= option.text %></label> </div> <% }); %> </div> <% } %>',f["fields/select.html"]="<% if (field.readonly) { %> <div class=\"coreui-form__field-readonly col-form-label\"><%= render.selectedOptions.join(', ') %></div> <% } else { %> <select <%- render.attr %>> <% $.each(render.options, function(key, option) { %> <% if (option.type === 'group') { %> <optgroup<%- option.attr %>/> <% $.each(option.options, function(key, groupOption) { %> <option <%- groupOption.attr %>/><%= groupOption.text %></option> <% }); %> </optgroup> <% } else { %> <option <%- option.attr %>/><%= option.text %></option> <% } %> <% }); %> </select> <% } %>",f["fields/switch.html"]='<% if (field.readonly) { %> <div class="coreui-form__field-readonly col-form-label"><%= field.valueY == value ? lang.switch_yes : lang.switch_no %></div> <% } else { %> <div class="form-check form-switch pt-2"> <input <%- render.attr %>/> </div> <% } %>',f["fields/textarea.html"]='<% if (field.readonly) { %> <div class="coreui-form__field-readonly col-form-label"><%- value %></div> <% } else { %> <textarea <%- render.attr %>><%- value %></textarea> <% } %>',f["fields/wysiwyg.html"]='<% if (field.readonly) { %> <div class="coreui-form__field-readonly col-form-label"><%- value %></div> <% } else { %> <textarea name="<%= field.name %>" id="editor-<%= editorHash %>"><%- value %></textarea> <% } %>';var t,e,i,p=function(t,e,i,n){i=i||[];var o=[];if(t._events[e]instanceof Object&&0<t._events[e].length)for(var s=0;s<t._events[e].length;s++){var r=t._events[e][s].callback,a=t._events[e][s].context||n||t;o.push(r.apply(a,i)),t._events[e][s].singleExec&&(t._events[e].splice(s,1),s--)}return o},_=function(t,e){if("object"!==c(e))return null;var i=e.hasOwnProperty("type")&&"string"==typeof e.type?e.type:"input";if("group"===i)return null;o.fields.hasOwnProperty(i)||(i="input"),t._options.readonly&&(e.readonly=!0);i=$.extend(!0,{render:function(){},renderContent:function(){},init:function(){},getValue:function(){},setValue:function(){},getOptions:function(){},show:function(){},hide:function(){},readonly:function(){},validate:function(){},isValid:function(){}},o.fields[i]);return i.init(t,e,t._fieldsIndex++),t._fields.push(i),i},m=function(t,e){var i;return"object"!==c(e)||"group"!==(i=e.hasOwnProperty("type")&&"string"==typeof e.type?e.type:"")?null:((i=$.extend(!0,{render:function(){},init:function(){},getOptions:function(){},expand:function(){},collapse:function(){}},o.fields[i])).init(t,e,t._groupsIndex++),t._groups.push(i),i)},v=function(t,e){if("object"!==c(e))return null;var i=e.hasOwnProperty("type")&&"string"==typeof e.type?e.type:null;if(!i||!o.controls.hasOwnProperty(i))return null;"submit"===i&&t._options.readonly&&(e.show=!1);i=$.extend(!0,{render:function(){},init:function(){},getOptions:function(){},show:function(){},hide:function(){}},o.controls[i]);return i.init(t,e,t._controlsIndex++),t._controls.push(i),i},g={getFieldValue:function(t,e){t=t.getRecord();return e&&t&&"string"==typeof e.name&&"object"===c(t)&&t.hasOwnProperty(e.name)&&0<=["string","number","object"].indexOf(c(t[e.name]))?t[e.name]:""},getFunctionByName:function(t,e){var i=t.split("."),t=i.pop();e=e||window;for(var n=0;n<i.length;n++){if(!e.hasOwnProperty(i[n]))return null;e=e[i[n]]}return"function"==typeof e[t]?e[t]:null},mergeFieldOptions:function(t,e,i){e=$.extend(!0,{},e);return i&&(e.hasOwnProperty("attr")&&"object"===c(e.attr)&&i.hasOwnProperty("attr")&&"object"===c(i.attr)&&(i.attr=this.mergeAttr(e.attr,i.attr)),e=$.extend(!0,{},e,i)),e.hasOwnProperty("width")&&(e.width?(i="number"==typeof e.width?"px":"",e.width=e.width+i):t._options.fieldWidth&&"color"!==e.type&&(i="number"==typeof t._options.fieldWidth?"px":"",e.width=t._options.fieldWidth+i)),e.hasOwnProperty("labelWidth")&&(0<=e.labelWidth&&null!==e.labelWidth?(i="number"==typeof e.labelWidth?"px":"",e.labelWidth=e.labelWidth+i):t._options.labelWidth&&(i="number"==typeof t._options.labelWidth?"px":"",e.labelWidth=t._options.labelWidth+i)),e},mergeAttr:function(t,e){var i=Object.assign({},t);return"object"===c(e)&&$.each(e,function(t,e){i.hasOwnProperty(t)?"class"===t?i[t]+=" "+e:"style"===t?i[t]+=";"+e:i[t]=e:i[t]=e}),i},getAttacheFields:function(i,n){var o=[];return"object"===c(n)&&"object"===c(n.fields)&&Array.isArray(n.fields)&&$.each(n.fields,function(t,e){e=_(i,e);"object"===c(e)&&o.push({hash:e._hash,direction:n.hasOwnProperty("fieldsDirection")?n.fieldsDirection:"row",content:e.renderContent()})}),o},formatDate:function(t){var e,i,n;return t&&10===t.length&&(e=(i=new Date(t)).getFullYear(),n=i.getMonth()+1,t=(i=(i=i.getDate())<10?"0"+i:i)+"."+(n=n<10?"0"+n:n)+"."+e),t},formatDateTime:function(t){var e,i,n,o;return t&&10<=t.length&&(i=(e=new Date(t)).getFullYear(),o=e.getMonth()+1,t=(n=(n=e.getDate())<10?"0"+n:n)+"."+(o=o<10?"0"+o:o)+"."+i+" "+("00"+e.getHours()).slice(-2)+":"+("00"+e.getMinutes()).slice(-2)+":"+("00"+e.getSeconds()).slice(-2)),t},formatDateMonth:function(t,e){var i,n;return t&&7===t.length&&(i=(n=new Date(t)).getFullYear(),n=n.getMonth(),t=(e.date_months.hasOwnProperty(n)?e.date_months[n]:"")+" "+i),t},formatDateWeek:function(t,e){var i,n;return t&&7<=t.length&&(i=t.substring(0,4),n=t.substring(6),t=i+" "+e.date_week+" "+n),t},getObjValue:function(t,e){for(var i=0,n=(e=e.split(".")).length;i<n;i++)t=t[e[i]];return t},isJson:function(t){if("string"!=typeof t)return!1;try{var e=JSON.parse(t);return"object"===c(e)||Array.isArray(e)}catch(t){return!1}},isObject:function(t){return"object"===c(t)&&!Array.isArray(t)&&null!==t},isNumeric:function(t){return("number"==typeof t||"string"==typeof t&&""!==t.trim())&&!isNaN(t)},hashCode:function(){return this.crc32(((new Date).getTime()+Math.random()).toString()).toString(16)},crc32:function(t){for(var e=[],i=0;i<256;i++){for(var n=i,o=0;o<8;o++)n=1&n?3988292384^n>>>1:n>>>1;e[i]=n}for(var s=-1,r=0;r<t.length;r++)s=s>>>8^e[255&(s^t.charCodeAt(r))];return(-1^s)>>>0},round:function(t,e){var i;return 0===(e=void 0!==e?parseInt(e):0)?Math.round(t):0<e?(i=Math.pow(10,e),Math.round(t*i)/i):(i=Math.pow(10,e),Math.round(t/i)*i)}},n={_options:{id:null,title:"",lang:"en",langList:{},send:{url:"",method:"POST",format:"form"},validResponse:{headers:null,dataType:null},width:null,minWidth:null,maxWidth:null,labelWidth:200,fieldWidth:null,controlsOffset:null,readonly:!1,validate:!1,successLoadUrl:"",errorClass:"",layout:"[position_default]",onSubmit:null,onSubmitSuccess:null,errorMessageScrollOffset:70,record:{},fields:[],controls:[]},_lock:!1,_fieldsIndex:0,_groupsIndex:0,_controlsIndex:0,_groups:[],_fields:[],_controls:[],_events:{},_init:function(t){this._options=$.extend(!0,{},this._options,t),this._options.id||(this._options.id=g.hashCode()),this._options.hasOwnProperty("labelWidth")&&0<=this._options.labelWidth&&null!==this._options.labelWidth&&(t="number"==typeof this._options.labelWidth?"px":"",this._options.labelWidth=this._options.labelWidth+t),this._options.hasOwnProperty("controlsOffset")&&null!==this._options.controlsOffset?0<=this._options.controlsOffset&&(t="number"==typeof this._options.controlsOffset?"px":"",this._options.controlsOffset=this._options.controlsOffset+t):this._options.controlsOffset=this._options.labelWidth},initEvents:function(){var t=this,e="#coreui-form-"+this._options.id+" > form";$(e).on("submit",function(){return setTimeout(function(){t.send.apply(t)},0),!1}),p(this,"show")},getId:function(){return this._options.hasOwnProperty("id")?this._options.id:null},render:function(t){var o,s=this,e=[],i=this._options.layout&&"string"==typeof this._options.layout?this._options.layout:"[position_default]",n=[],r=[],a=(this._options.width&&(l="number"==typeof this._options.width?"px":"",e.push("width:"+this._options.width+l)),this._options.minWidth&&(l="number"==typeof this._options.minWidth?"px":"",e.push("min-width:"+this._options.minWidth+l)),this._options.maxWidth&&(l="number"==typeof this._options.maxWidth?"px":"",e.push("max-width:"+this._options.maxWidth+l)),[]),l=Array.from(i.matchAll(/\[position_([\w_\d]+)\]/g)),d=(0<l.length&&$.each(l,function(t,e){a.push(e[1]),i=i.replace("[position_"+e[1]+"]",'<div class="coreui-form-position-'+e[1]+'"></div>')}),$(i)),h=("object"===c(this._options.fields)&&Array.isArray(this._options.fields)&&0<this._options.fields.length&&(o={},0<a.length&&$.each(this._options.fields,function(t,e){var i,n=!e.hasOwnProperty("position")||"string"!=typeof e.position&&"number"!=typeof e.position?"default":0<=a.indexOf(e.position)?e.position:null;"string"==typeof n&&(i=null,i=("group"===(e.hasOwnProperty("type")&&"string"==typeof e.type?e.type:"")?m:_)(s,e))&&"object"===c(i)&&(o.hasOwnProperty(n)||(o[n]=[]),o[n].push(i.render()))}),0<=Object.keys(o).length)&&$.each(o,function(n,t){$.each(t,function(t,e){var i=d.closest(".coreui-form-position-"+n);(i=i[0]?i:d.find(".coreui-form-position-"+n)).append(e)})}),"object"===c(this._options.controls)&&Array.isArray(this._options.controls)&&0<this._options.controls.length&&$.each(this._options.controls,function(t,e){var i=v(s,e);i&&"object"===c(i)&&n.push({show:!e.hasOwnProperty("show")||e.show,index:s._controlsIndex-1,content:i.render()})}),"boolean"==typeof this._options.validate&&this._options.validate&&r.push("novalidate"),$(ejs.render(f["form.html"],{form:this._options,formAttr:r?" "+r.join(" "):"",widthSizes:e,controls:n}))),u=(h.find(".coreui-form__fields").append(d),this.getId());if($.each(n,function(t,e){h.find("#coreui-form-"+u+"-control-"+e.index).append(e.content)}),void 0===t)return h;l=null;"string"==typeof t?l=document.getElementById(t):t instanceof HTMLElement&&(l=t),l&&($(l).html(h),this.initEvents())},lock:function(){this._lock=!0,$.each(this._controls,function(t,e){var i=e.getOptions();i.hasOwnProperty("type")&&"submit"===i.type&&e.lock()})},unlock:function(){this._lock=!1,$.each(this._controls,function(t,e){var i=e.getOptions();i.hasOwnProperty("type")&&"submit"===i.type&&e.unlock()})},send:function(){if(!this._lock){if("boolean"==typeof this._options.validate&&this._options.validate)if(!this.validate())return;var t=null,e=this.getData();if("function"==typeof this._options.onSubmit?t=this._options.onSubmit:"string"==typeof this._options.onSubmit&&this._options.onSubmit&&("function"==typeof(i=g.getFunctionByName(this._options.onSubmit))?t=i:"string"==typeof this._options.onSubmit&&(t=new Function("form","data",this._options.onSubmit))),"function"==typeof t)if(!1===t(this,e))return;var h,n,u,i=p(this,"send",[this,e]),o=!1;$.each(i,function(t,e){if(!1===e)return!(o=!0)}),o||(this.lock(),h=this,t=0<=["form","json"].indexOf(this._options.send.format)?this._options.send.format:"form",i=n=null,"json"===t?(i="application/json; charset=utf-8",n=JSON.stringify(e)):(i=!1,n=new FormData,$.each(e,function(i,t){t instanceof File?n.append(i,t,t.name):t instanceof FileList?$.each(t,function(t,e){n.append(i,e,e.name)}):n.append(i,t)})),u=function(t,e,i){var n=h.getLang().send_error||"",o={};try{var s=JSON.parse(t.responseText);"object"!==c(s)||null===s||Array.isArray(s)||(o=s)}catch(t){}o.hasOwnProperty("error_message")&&"string"==typeof o.error_message&&""!==o.error_message&&(n=o.error_message),h.showError(n),p(h,"send_error",[h,t,e,i])},$.ajax({url:this._options.send.url,method:this._options.send.method,data:n,contentType:i,processData:!1,beforeSend:function(t){p(h,"send_start",[h,t])},success:function(i,t,n){var o=!0;if("object"===c(h._options.validResponse)&&(Array.isArray(h._options.validResponse.headers)&&$.each(h._options.validResponse.headers,function(t,e){if("string"==typeof e){if(n.getResponseHeader(t)!=e)return o=!1}else if(Array.isArray(e)&&e.indexOf(n.getResponseHeader(t))<0)return o=!1}),o)&&("string"==typeof h._options.validResponse.dataType?"json"!==h._options.validResponse.dataType||"object"===c(i)||Array.isArray(i)||g.isJson(i)||(o=!1):Array.isArray(h._options.validResponse.dataType)&&$.each(h._options.validResponse.dataType,function(t,e){if("json"===e&&"object"!==c(i)&&!Array.isArray(i)&&!g.isJson(i))return o=!1})),o){var e=i,s=(h.hideError(),p(h,"send_success",[h,e]),null);if("string"==typeof e)try{var r=JSON.parse(e);"object"!==c(r)||null===r||Array.isArray(r)||(s=r)}catch(t){}else s=e;if(null!==s&&"object"===c(s)&&(s.hasOwnProperty("scripts")&&Array.isArray(s.scripts)&&$.each(s.scripts,function(t,e){"string"==typeof e&&new Function(e)()}),s.hasOwnProperty("loadUrl"))&&"string"==typeof s.loadUrl&&(location.href=s.loadUrl),h._options.hasOwnProperty("onSubmitSuccess")&&("function"==typeof h._options.onSubmitSuccess?h._options.onSubmitSuccess():"string"==typeof h._options.onSubmitSuccess&&new Function(h._options.onSubmitSuccess)()),h._options.hasOwnProperty("successLoadUrl")&&"string"==typeof h._options.successLoadUrl&&""!==h._options.successLoadUrl){var a=h._options.successLoadUrl;if(null!==s&&"object"===c(s)){for(var l=new RegExp("\\[response\\.([\\d\\w\\.]+)\\]","uig"),d={};e=l.exec(a);)d[e[0]]=e[1];0<Object.keys(d).length&&$.each(d,function(t,e){e=void 0!==(e=g.getObjValue(s,e))?e:"";a=a.replace(new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),e)})}r=location.hash===a;location.href=a,r&&window.onhashchange()}}else u(n,t)},error:u,complete:function(t,e){h.unlock(),p(h,"send_end",[h,t,e])}}))}},getOptions:function(){return this._options},getRecord:function(){return this._options.hasOwnProperty("record")&&"object"===c(this._options.record)?this._options.record:{}},getData:function(){var n={};return $.each(this._fields,function(t,e){var i=e.getOptions();i.hasOwnProperty("name")&&i.name&&null!==(e=e.getValue())&&(n[i.name]=e)}),n},getFields:function(){return this._fields},getControls:function(){return this._controls},getGroups:function(){return this._groups},getField:function(n){var o={};return $.each(this._fields,function(t,e){var i=e.getOptions();i.hasOwnProperty("name")&&i.name===n&&(o=e)}),o},readonly:function(n){$.each(this._fields,function(t,e){e.readonly(n)}),$.each(this._controls,function(t,e){var i=e.getOptions();i.hasOwnProperty("type")&&"submit"===i.type&&(n?e.hide():e.show())})},showControls:function(){$.each(this._controls,function(t,e){e.show()})},hideControls:function(){$.each(this._controls,function(t,e){e.hide()})},validate:function(){var i=!0;return $.each(this._fields,function(t,e){!1===e.isValid()?(e.validate(!1),i=!1):e.validate(null)}),i},showError:function(t,e){var i=$("#coreui-form-"+this._options.id+" > form"),n=i.find("> .coreui-form__error"),n=(n[0]&&n.remove(),e="object"!==c(e)||Array.isArray(e)||null===e?{}:e,"string"==typeof this._options.errorClass&&""!==this._options.errorClass&&(e.class=e.hasOwnProperty("class")?e.class:"",e.class+=" "+this._options.errorClass),{class:e.hasOwnProperty("class")&&"string"==typeof e.class?e.class:"",dismiss:!e.hasOwnProperty("dismiss")||!!e.dismiss});i.prepend(ejs.render(f["form-error.html"],{message:t,options:n})),e.hasOwnProperty("scroll")&&!e.scroll||$("html,body").animate({scrollTop:i.offset().top-e.errorMessageScrollOffset},"fast")},hideError:function(){$("#coreui-form-"+this._options.id+" > form > .coreui-form__error").remove()},on:function(t,e,i){"object"!==c(this._events[t])&&(this._events[t]=[]),this._events[t].push({context:i||this,callback:e,singleExec:!1})},one:function(t,e,i){"object"!==c(this._events[t])&&(this._events[t]=[]),this._events[t].push({context:i||this,callback:e,singleExec:!0})},destruct:function(){$("#coreui-form-"+this._options.id).remove(),delete o._instances[this.getId()]},getLang:function(){return $.extend(!0,{},this._options.langList)}},o={lang:{},fields:{},controls:{},_instances:{},_settings:{labelWidth:200,lang:"en",class:"",sendDataFormat:"form",errorMessageScrollOffset:70},create:function(t){g.isObject(t)||(t={}),(t=$.extend(!0,{},t)).hasOwnProperty("lang")||(t.lang=this.getSetting("lang"));var e=this.lang.hasOwnProperty(t.lang)?this.lang[t.lang]:{},e=(t.langList=t.hasOwnProperty("langList")&&g.isObject(t.langList)?$.extend(!0,{},e,t.langList):e,t.errorMessageScrollOffset=t.hasOwnProperty("errorMessageScrollOffset")&&g.isNumeric(t.errorMessageScrollOffset)?t.errorMessageScrollOffset:this.getSetting("errorMessageScrollOffset"),t.labelWidth=t.hasOwnProperty("labelWidth")?t.labelWidth:this.getSetting("labelWidth"),t.errorClass=t.hasOwnProperty("errorClass")&&"string"==typeof t.errorClass?t.errorClass:this.getSetting("errorClass"),t.hasOwnProperty("send")&&g.isObject(t.send)&&t.send.hasOwnProperty("format")&&"string"==typeof t.send.format||(t.hasOwnProperty("send")&&g.isObject(t.send)||(t.send={}),t.send.format=this.getSetting("sendDataFormat")),$.extend(!0,{},n)),t=(e._init(t),e.getId());return this._instances[t]=e},get:function(t){return this._instances.hasOwnProperty(t)?$("#coreui-form-"+t)[0]?this._instances[t]:(delete this._instances[t],null):null},setSettings:function(t){this._settings=$.extend({},this._settings,t)},getSetting:function(t){var e=null;return e=this._settings.hasOwnProperty(t)?this._settings[t]:e}};o.lang.ru={modal_select:"Выбрать",modal_loading:"Загрузка...",switch_yes:"Да",switch_no:"Нет",dataset_add:"Добавить",date_months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],date_week:"неделя",file_upload_select:"Выберите файл",file_upload_dropzone:"Поместите сюда свои файлы",send_error:"Произошла ошибка. Попробуйте снова или обратитесь к администратору",required_field:"Обязательное поле",change:"изменить",cancel:"отмена"},o.lang.en={modal_select:"Select",modal_loading:"Loading...",switch_yes:"Yes",switch_no:"No",dataset_add:"Add",date_months:["January","February","March","April","May","June","July","August","September","October","November","December"],date_week:"week",file_upload_select:"Выберите файл",file_upload_dropzone:"Drop your files here",send_error:"An error has occurred. Please try again or contact your administrator",required_field:"Required field",change:"change",cancel:"cancel"},o.controls.button={_form:null,_index:null,_options:{type:"button",content:null,onClick:null,attr:{class:"btn btn-secondary"}},init:function(t,e,i){this._options=$.extend({},this._options,e),this._form=t,this._index=i;var n=this;t.on("show",function(){n._initEvents()})},getOptions:function(){return $.extend(!0,{},this._options)},render:function(){var i=[],t=this.getOptions();return t.attr.type="button",$.each(t.attr,function(t,e){i.push(t+'="'+e+'"')}),ejs.render(f["controls/button.html"],{control:this._options,render:{attr:0<i.length?" "+i.join(" "):""}})},show:function(t){$("#coreui-form-"+this._form.getId()+"-control-"+this._index).show(t||0)},hide:function(t){$("#coreui-form-"+this._form.getId()+"-control-"+this._index).hide(t||0)},lock:function(){var t=$("#coreui-form-"+this._form.getId()+"-control-"+this._index+" > button");t.find(".spinner-border")[0]||t.prepend('<span class="spinner-border spinner-border-sm"></span> '),t.attr("disabled")||t.attr("disabled","disabled")},_initEvents:function(){var e=this;0<=["function","string"].indexOf(c(this._options.onClick))&&$("#coreui-form-"+this._form.getId()+"-control-"+this._index+" > button").click(function(t){"function"==typeof e._options.onClick?e._options.onClick(e._form,t):new Function("form","event",e._options.onClick)(e._form,t)})}},o.controls.custom={_form:null,_index:null,_options:{type:"custom",content:null},init:function(t,e,i){this._options=$.extend({},this._options,e),this._form=t,this._index=i},getOptions:function(){return $.extend(!0,{},this._options)},show:function(t){$("#coreui-form-"+form.getId()+"-control-"+this._index).show(t||0)},hide:function(t){$("#coreui-form-"+form.getId()+"-control-"+this._index).hide(t||0)},render:function(){return this._options.content}},o.controls.link={_form:null,_index:null,_options:{type:"link",url:null,content:null,onClick:null,attr:{class:"btn btn-link"}},init:function(t,e,i){this._options=$.extend({},this._options,e),this._form=t,this._index=i;var n=this;t.on("show",function(){n._initEvents()})},getOptions:function(){return $.extend(!0,{},this._options)},show:function(t){$("#coreui-form-"+this._form.getId()+"-control-"+this._index).show(t||0)},hide:function(t){$("#coreui-form-"+this._form.getId()+"-control-"+this._index).hide(t||0)},lock:function(){var t=$("#coreui-form-"+this._form.getId()+"-control-"+this._index+" > button");t.find(".spinner-border")[0]||t.prepend('<span class="spinner-border spinner-border-sm"></span> '),t.attr("disabled")||t.attr("disabled","disabled")},render:function(){var i=[],t=this.getOptions();return $.each(t.attr,function(t,e){i.push(t+'="'+e+'"')}),ejs.render(f["controls/link.html"],{control:this._options,render:{attr:0<i.length?" "+i.join(" "):""}})},_initEvents:function(){var e=this;0<=["function","string"].indexOf(c(this._options.onClick))&&$("#coreui-form-"+this._form.getId()+"-control-"+this._index+" > a").click(function(t){"function"==typeof e._options.onClick?e._options.onClick(e._form,t):new Function("form","event",e._options.onClick)(e._form,t)})}},o.controls.submit={_form:null,_index:null,_options:{type:"submit",content:null,onClick:null,show:!0,attr:{class:"btn btn-primary"}},init:function(t,e,i){this._options=$.extend({},this._options,e),this._form=t,this._index=i;var n=this;t.on("show",function(){n._initEvents()})},getOptions:function(){return $.extend(!0,{},this._options)},show:function(t){$("#coreui-form-"+this._form.getId()+"-control-"+this._index).show(t||0)},hide:function(t){$("#coreui-form-"+this._form.getId()+"-control-"+this._index).hide(t||0)},lock:function(){var t=$("#coreui-form-"+this._form.getId()+"-control-"+this._index+" > button");t.find(".spinner-border")[0]||t.prepend('<span class="spinner-border spinner-border-sm"></span> '),t.attr("disabled")||t.attr("disabled","disabled")},unlock:function(){var t=$("#coreui-form-"+this._form.getId()+"-control-"+this._index+" > button");t.find(".spinner-border").remove(),t.removeAttr("disabled")},render:function(){var i=[],t=this.getOptions();return t.attr.type="submit",$.each(t.attr,function(t,e){i.push(t+'="'+e+'"')}),ejs.render(f["controls/button.html"],{control:this._options,render:{attr:0<i.length?" "+i.join(" "):""}})},_initEvents:function(){var e=this;0<=["function","string"].indexOf(c(this._options.onClick))&&$("#coreui-form-"+this._form.getId()+"-control-"+this._index+" > button").click(function(t){"function"==typeof e._options.onClick?e._options.onClick(e._form,t):new Function("form","event",e._options.onClick)(e._form,t)})}},o.fields.checkbox={_id:"",_hash:"",_form:null,_index:0,_value:[],_options:{type:"checkbox",name:null,label:null,labelWidth:null,inline:!1,outContent:null,description:null,errorText:null,options:[],fields:null,required:null,readonly:null,show:!0,column:null},init:function(t,e,i){this._form=t,this._id=t.getId()+"-field-"+(e.hasOwnProperty("name")?e.name:i),this._hash=g.hashCode(),this._value=g.getFieldValue(t,e),this._options=g.mergeFieldOptions(t,this._options,e)},getOptions:function(){return $.extend(!0,{},this._options)},readonly:function(t){this._value=this.getValue(),this._options.readonly=!!t,$(".content-"+this._hash).html(this.renderContent())},hide:function(t){$("#coreui-form-"+this._id).hide(t)},show:function(t){$("#coreui-form-"+this._id).show(t)},getValue:function(){var t;return this._options.readonly?this._value:(t=[],$(".content-"+this._hash+" input[type=checkbox]:checked").each(function(){t.push($(this).val())}),t)},setValue:function(e){if(!(["string","number","object"].indexOf(c(e))<0)){if("object"===c(e)){if(null!==e&&!Array.isArray(e))return}else e=[e];var t,n,o=this;this._value=[],this._options.readonly?($(".content-"+o._hash).empty(),(t=this.getOptions()).hasOwnProperty("options")&&"object"===c(t.options)&&Array.isArray(t.options)&&Array.isArray(e)&&(n=[],$.each(t.options,function(t,i){i.hasOwnProperty("value")&&$.each(e,function(t,e){if(i.value==e)return i.hasOwnProperty("text")&&0<=["string","number"].indexOf(c(i.text))&&n.push(i.text),o._value.push(e),!1})}),$(".content-"+o._hash).text(n.join(", ")))):($(".content-"+this._hash+" input[type=radio]").prop("checked",!1),Array.isArray(e)&&$(".content-"+this._hash+" input[type=radio]").each(function(t,i){$.each(e,function(t,e){if(e==$(i).val())return $(i).prop("checked",!0),o._value.push(e),!1})}))}},validate:function(t,e){var i,n,o;this._options.readonly||(i=$(".content-"+this._hash),n=$(".form-check:last-child",i),o=$("input",i),i.find(".valid-feedback").remove(),i.find(".invalid-feedback").remove(),null===t?(o.removeClass("is-invalid"),o.removeClass("is-valid")):t?(o.removeClass("is-invalid"),o.addClass("is-valid"),"string"==typeof(e=void 0===e&&"string"==typeof this._options.validText?this._options.validText:e)&&n.append('<div class="valid-feedback">'+e+"</div>")):(o.removeClass("is-valid"),o.addClass("is-invalid"),void 0===e&&("string"==typeof this._options.invalidText?e=this._options.invalidText:!e&&this._options.required&&(e=this._form.getLang().required_field)),"string"==typeof e&&n.append('<div class="invalid-feedback">'+e+"</div>")))},isValid:function(){return!(this._options.required&&!this._options.readonly)||0<this.getValue().length},render:function(){var t=this.getOptions(),t=g.getAttacheFields(this._form,t);return ejs.render(f["form-field-label.html"],{id:this._id,form:this._form,hash:this._hash,field:this._options,content:this.renderContent(),attachFields:t})},renderContent:function(){var s=this,r=[],a=this.getOptions(),l=[],t=(a.hasOwnProperty("options")&&"object"===c(a.options)&&Array.isArray(a.options)&&$.each(a.options,function(t,i){var n=[],o={type:"checkbox",class:"form-check-input"},e=i.hasOwnProperty("text")&&0<=["string","number"].indexOf(c(i.text))?i.text:"";a.name&&(o.name=s._options.name),a.required&&(o.required="required"),$.each(i,function(t,e){"text"!==t&&(o[t]="class"===t?o[t]+" "+e:e)}),o.id=g.hashCode(),"object"===c(s._value)&&Array.isArray(s._value)?$.each(s._value,function(t,e){if(e==i.value)return o.checked="checked",i.hasOwnProperty("text")&&i.text&&l.push(i.text),!1}):s._value==i.value&&(i.hasOwnProperty("text")&&i.text&&l.push(i.text),o.checked="checked"),$.each(o,function(t,e){n.push(t+'="'+e+'"')}),r.push({id:o.id,text:e,attr:0<n.length?" "+n.join(" "):""})}),"object"===c(this._value)&&Array.isArray(this._value)?this._value.join(", "):this._value);return ejs.render(f["fields/checkbox.html"],{field:a,value:t,render:{options:r,selectedItems:l}})}},o.fields.color={_id:"",_hash:"",_form:null,_index:0,_value:"",_options:{type:"color",name:null,label:null,labelWidth:null,width:null,outContent:null,description:null,errorText:null,attach:null,attr:{class:"form-control form-control-color d-inline-block"},required:null,readonly:null,datalist:null,show:!0,column:null},init:function(t,e,i){this._form=t,this._id=t.getId()+"-field-"+(e.hasOwnProperty("name")?e.name:i),this._hash=g.hashCode(),this._value=g.getFieldValue(t,e),this._options=g.mergeFieldOptions(t,this._options,e)},getOptions:function(){return $.extend(!0,{},this._options)},readonly:function(t){this._value=this.getValue(),this._options.readonly=!!t,$(".content-"+this._hash).html(this.renderContent())},hide:function(t){$("#coreui-form-"+this._id).hide(t)},show:function(t){$("#coreui-form-"+this._id).show(t)},getValue:function(){return this._options.readonly?this._value:$(".content-"+this._hash+" input").val()},setValue:function(t){["string","number"].indexOf(c(t))<0||(this._value=t,this._options.readonly?$(".content-"+this._hash).text(t):$(".content-"+this._hash+" input").val(t))},validate:function(t,e){var i,n;this._options.readonly||(i=$(".content-"+this._hash),n=$("input",i),i.find(".valid-feedback").remove(),i.find(".invalid-feedback").remove(),null===t?(n.removeClass("is-invalid"),n.removeClass("is-valid")):t?(n.removeClass("is-invalid"),n.addClass("is-valid"),"string"==typeof(e=void 0===e&&"string"==typeof this._options.validText?this._options.validText:e)&&i.append('<div class="valid-feedback">'+e+"</div>")):(n.removeClass("is-valid"),n.addClass("is-invalid"),void 0===e&&("string"==typeof this._options.invalidText?e=this._options.invalidText:!e&&this._options.required&&(e=this._form.getLang().required_field)),"string"==typeof e&&i.append('<div class="invalid-feedback">'+e+"</div>")))},isValid:function(){var t=$(".content-"+this._hash+" input");return t[0]?t.is(":valid"):null},render:function(){var t=this.getOptions(),e=g.getAttacheFields(this._form,t);return ejs.render(f["form-field-label.html"],{id:this._id,form:this._form,hash:this._hash,field:t,content:this.renderContent(),attachFields:e})},renderContent:function(){return this._options.readonly?this._renderContentReadonly():this._renderContent()},_renderContent:function(){var i=[],n=[],t=this.getOptions(),e=g.hashCode();return t.hasOwnProperty("attr")&&"object"===c(t.attr)&&null!==t.attr&&!Array.isArray(t.attr)||(t.attr={}),t.name&&(t.attr.name=this._options.name),t.attr.type=t.type,t.attr.value=this._value,t.width&&(t.attr=g.mergeAttr({style:"width:"+t.width},t.attr)),t.required&&(t.attr.required="required"),t.hasOwnProperty("datalist")&&"object"===c(t.datalist)&&Array.isArray(t.datalist)&&(t.attr.list=e,$.each(t.datalist,function(t,e){var i=[];$.each(e,function(t,e){i.push(t+'="'+e+'"')}),n.push({attr:0<i.length?" "+i.join(" "):""})})),$.each(t.attr,function(t,e){i.push(t+'="'+e+'"')}),ejs.render(f["fields/color.html"],{field:t,datalistId:e,value:this._value,render:{attr:0<i.length?" "+i.join(" "):"",datalist:n}})},_renderContentReadonly:function(){var t=this.getOptions();return ejs.render(f["fields/color.html"],{field:t,value:this._value})}},o.fields.custom={_id:"",_hash:"",_form:null,_value:null,_options:{type:"custom",label:null,labelWidth:null,width:null,content:"",outContent:null,description:null,required:null,show:!0,column:null},init:function(t,e,i){this._form=t,this._id=t.getId()+"-field-"+(e.hasOwnProperty("name")?e.name:i),this._value=g.getFieldValue(t,e),this._options=g.mergeFieldOptions(t,this._options,e),this._hash=g.hashCode()},getOptions:function(){return $.extend(!0,{},this._options)},readonly:function(t){},hide:function(t){$("#coreui-form-"+this._id).hide(t)},show:function(t){$("#coreui-form-"+this._id).show(t)},getValue:function(){},setValue:function(t){},render:function(){var i=this,t=this.getOptions(),e=g.getAttacheFields(this._form,t),n=$(ejs.render(f["form-field-label.html"],{id:this._id,form:this._form,hash:this._hash,field:t,content:"",attachFields:e}));return $.each(this.renderContent(),function(t,e){n.find(".content-"+i._hash).append(e)}),n},renderContent:function(){var t=this.getOptions().content,e=[];if("string"==typeof t)e.push(t);else if(t instanceof Object){Array.isArray(t)||(t=[t]);for(var i,n=0;n<t.length;n++)"string"==typeof t[n]?e.push(t[n]):!Array.isArray(t[n])&&t[n].hasOwnProperty("component")&&"string"==typeof t[n].component&&"coreui"===t[n].component.substring(0,6)?(i=t[n].component.split(".")[1],CoreUI.hasOwnProperty(i)&&g.isObject(CoreUI[i])&&(i=CoreUI[i].create(t[n]),e.push(i.render()),this._form.on("show",i.initEvents,i,!0))):e.push(JSON.stringify(t[n]))}return e}},o.fields.dataset={_id:"",_hash:"",_form:null,_value:[],_renderOptions:[],_options:{type:"dataset",name:null,label:null,labelWidth:null,outContent:null,description:null,errorText:null,attach:null,required:null,readonly:null,show:!0,column:null},init:function(t,a,e){this._form=t,this._id=t.getId()+"-field-"+(a.hasOwnProperty("name")?a.name:e),this._value=g.getFieldValue(t,a),this._options=g.mergeFieldOptions(t,this._options,a),this._hash=g.hashCode();var l=this;t.on("show",function(){l._options.readonly||l._initEvents()}),a.hasOwnProperty("options")&&"object"===c(a.options)&&Array.isArray(a.options)&&$.each(a.options,function(t,e){var i=e.hasOwnProperty("name")&&0<=["string","number"].indexOf(c(e.name))?e.name:"",n=e.hasOwnProperty("type")&&"string"==typeof e.type?e.type:"text",o=e.hasOwnProperty("attr")&&"object"===c(e.attr)&&!Array.isArray(e.attr)?e.attr:{},s=e.hasOwnProperty("items")&&"object"===c(e.items)&&Array.isArray(e.items)?e.items:[],r=e.hasOwnProperty("valueY")&&0<=["string","numeric"].indexOf(c(e.valueY))?e.valueY:"Y",e=e.hasOwnProperty("valueN")&&0<=["string","numeric"].indexOf(c(e.valueN))?e.valueN:"N";i&&(o.name=i),a.required&&(o.required="required"),"select"===n?o.class=o.hasOwnProperty("class")?"form-select "+o.class:"form-select":"switch"===n?(o.class=o.hasOwnProperty("class")?"form-check-input "+o.class:"form-check-input",o.type="checkbox",o.value=r):(o.class=o.hasOwnProperty("class")?"form-control "+o.class:"form-control",o.type=n),l._renderOptions.push({type:n,name:i,attr:o,items:s,valueY:r,valueN:e})})},getOptions:function(){return $.extend(!0,{},this._options)},readonly:function(t){this._value=this.getValue(),this._options.readonly=!!t,$(".content-"+this._hash).html(this.renderContent()),this._options.readonly||this._initEvents()},hide:function(t){$("#coreui-form-"+this._id).hide(t)},show:function(t){$("#coreui-form-"+this._id).show(t)},getValue:function(){var t,e;return this._options.readonly?this._value:(t=$(".content-"+this._hash),e=[],$(".coreui-form__field-dataset-list .coreui-form__field-dataset-item",t).each(function(){var i={};$.each($(this).find("input, select").serializeArray(),function(t,e){e.name&&(i[e.name]=e.value)}),e.push(i)}),e)},setValue:function(t){"object"!==c(t)||Array.isArray(t)||null===t||(this._value.push(t),this._options.readonly?$(".content-"+this._hash+" .coreui-form__field-dataset-list").append(this._renderRowReadonly(t)):this._eventAdd(t))},validate:function(t,e){var i;this._options.readonly||((i=$(".content-"+this._hash)).find(".text-success").remove(),i.find(".text-danger").remove(),null!==t&&(t?"string"==typeof(e=void 0===e&&"string"==typeof this._options.validText?this._options.validText:e)&&i.append('<div class="ps-2 text-success">'+e+"</div>"):(void 0===e&&("string"==typeof this._options.invalidText?e=this._options.invalidText:!e&&this._options.required&&(e=this._form.getLang().required_field)),"string"==typeof e&&i.append('<div class="ps-2 text-danger">'+e+"</div>"))))},isValid:function(){return!(this._options.required&&!this._options.readonly)||0<this.getValue().length},removeItems:function(){$("#coreui-form-"+this._id+" .content-"+this._hash+" .coreui-form__field-dataset-list").empty()},removeItem:function(t){var e="#coreui-form-"+this._id+" .content-"+this._hash;$("#"+t).hide("fast",function(){$("#"+t).remove(),0===$(e+" .coreui-form__field-dataset-item").length&&$(e+" .coreui-form__field-dataset-container").hide()})},render:function(){var t=this.getOptions(),e=g.getAttacheFields(this._form,t);return ejs.render(f["form-field-label.html"],{id:this._id,form:this._form,hash:this._hash,field:t,content:this.renderContent(),attachFields:e})},renderContent:function(){return this._options.readonly?this._renderContentReadonly():this._renderContent()},_renderContent:function(){var t=this.getOptions(),i=[],n=[],o=this;return t.hasOwnProperty("options")&&"object"===c(t.options)&&Array.isArray(t.options)&&($.each(t.options,function(t,e){e=e.hasOwnProperty("title")&&0<=["string","numeric"].indexOf(c(e.title))?e.title:"";n.push({title:e})}),"object"===c(this._value))&&Array.isArray(this._value)&&$.each(this._value,function(t,e){"object"!==c(e)||Array.isArray(e)||i.push(o._renderRow(e))}),ejs.render(f["fields/dataset.html"],{field:t,value:null!==this._value?this._value:"",lang:this._form.getLang(),render:{headers:n,rows:i}})},_renderContentReadonly:function(){var t=this.getOptions(),i=[],n=[],o=this;return t.hasOwnProperty("options")&&"object"===c(t.options)&&Array.isArray(t.options)&&($.each(t.options,function(t,e){e=e.hasOwnProperty("title")&&0<=["string","numeric"].indexOf(c(e.title))?e.title:"";n.push({title:e})}),"object"===c(this._value))&&Array.isArray(this._value)&&$.each(this._value,function(t,e){"object"!==c(e)||Array.isArray(e)||i.push(o._renderRowReadonly(e))}),ejs.render(f["fields/dataset.html"],{field:t,value:null!==this._value?this._value:"",lang:this._form.getLang(),render:{headers:n,rows:i}})},_initEvents:function(){var t=this,e="#coreui-form-"+this._id+" .content-"+this._hash;$(e+" .btn-dataset-remove").click(function(){t.removeItem($(this).data("item-id"))}),$(e+" .btn-dataset-add").click(function(){t._eventAdd()})},_eventAdd:function(t){var e=this,i="#coreui-form-"+this._id+" .content-"+this._hash;t=t||{},0===$(i+" .coreui-form__field-dataset-item").length&&$(i+" .coreui-form__field-dataset-container").show(),$(i+" .coreui-form__field-dataset-list").append(this._renderRow(t)),$(i+" .coreui-form__field-dataset-item:last-child .btn-dataset-remove").click(function(){e.removeItem($(this).data("item-id"))})},_renderRow:function(n){var o=[],a=[];return $.each(this._renderOptions,function(t,e){var r=n.hasOwnProperty(e.name)?n[e.name]:"",i=("select"===e.type?$.each(e.items,function(t,e){var i=e.hasOwnProperty("text")&&0<=["string","numeric"].indexOf(c(e.text))?e.text:"",n=e.hasOwnProperty("value")&&0<=["string","numeric"].indexOf(c(e.value))?e.value:"",o={},s=($.each(e,function(t,e){"text"!==t&&(o[t]=e)}),"object"===c(r)&&Array.isArray(r)?$.each(r,function(t,e){if(e==n)return!(o.selected="selected")}):r==e.value&&(o.selected="selected"),[]);$.each(o,function(t,e){s.push(t+'="'+e+'"')}),a.push({attr:0<s.length?" "+s.join(" "):"",text:i})}):"switch"===e.type?r==e.valueY&&(e.attr.checked="checked"):0<=["string","number"].indexOf(c(r))&&(e.attr.value=null!==r?r:""),[]);$.each(e.attr,function(t,e){i.push(t+'="'+e+'"')}),o.push({type:e.type,attr:0<i.length?" "+i.join(" "):"",items:a})}),ejs.render(f["fields/dataset-row.html"],{hashItem:g.hashCode(),options:o})},_renderRowReadonly:function(r){var a=[],l=this._form.getLang();return $.each(this._renderOptions,function(t,e){var i="",o=r.hasOwnProperty(e.name)?r[e.name]:"";if("select"===e.type){var s=[];$.each(e.items,function(t,e){var i=e.hasOwnProperty("text")&&0<=["string","numeric"].indexOf(c(e.text))?e.text:"",n=e.hasOwnProperty("value")&&0<=["string","numeric"].indexOf(c(e.value))?e.value:"";Array.isArray(o)?$.each(o,function(t,e){if(e==n)return s.push(i),!1}):o==n&&s.push(i)})}else if("switch"===e.type){var n="Y";e.hasOwnProperty("valueY")&&(n=e.valueY),i=o==n?l.switch_yes:l.switch_no}else if(0<=["string","number"].indexOf(c(o)))switch(i=o,e.type){case"date":i=g.formatDate(i);break;case"datetime-local":i=g.formatDateTime(i);break;case"month":i=g.formatDateMonth(i,l);break;case"week":i=g.formatDateWeek(i,l);break;default:i=o}a.push({value:i})}),ejs.render(f["fields/dataset-row-readonly.html"],{options:a})}},o.fields.group={_id:"",_form:null,_index:0,_options:{type:"group",label:"",show:!0,showCollapsible:!0,fields:[],column:null},init:function(t,e,i){this._form=t,this._index=i,this._id=t.getId()+"-group-"+i,this._options=$.extend(!0,{},this._options,e);var n=this;t.on("show",function(){n._initEvents()})},getOptions:function(){return $.extend(!0,{},this._options,options)},collapse:function(t){var e="#coreui-form-"+this._id;$(e+" > .coreui-form__group_label .btn-collapsible .bi").removeClass("bi-chevron-down"),$(e+" > .coreui-form__group_label .btn-collapsible .bi").addClass("bi-chevron-right"),$(e+" .coreui-form__group_content").slideUp(t)},expand:function(t){var e="#coreui-form-"+this._id;$(e+" > .coreui-form__group_label .btn-collapsible .bi").removeClass("bi-chevron-right"),$(e+" > .coreui-form__group_label .btn-collapsible .bi").addClass("bi-chevron-down"),$(e+" .coreui-form__group_content").slideDown(t)},render:function(){var t=$(ejs.render(f["form-field-group.html"],{id:this._id,form:this._form,group:this._options})),e=this.renderContent(),i=t.find(".coreui-form__group_content");return $.each(e,function(t,e){i.append(e)}),t},renderContent:function(){var i=[],n=this;return $.each(this._options.fields,function(t,e){e=_(n._form,e);"object"===c(e)&&i.push(e.render())}),i},_initEvents:function(){var t,e;this._options.showCollapsible&&(e="#coreui-form-"+(t=this)._id,$(e+" > .coreui-form__group_label .btn-collapsible").click(function(){$(e+" > .coreui-form__group_content").is(":visible")?t.collapse(80):t.expand(80)}))}},o.fields.hidden={_id:"",_form:null,_index:0,_value:"",_options:{type:"hidden",name:null,attr:{},required:null,column:null},init:function(t,e,i){this._form=t,this._id=t.getId()+"-field-"+(e.hasOwnProperty("name")?e.name:i),this._value=g.getFieldValue(t,e),this._options=g.mergeFieldOptions(t,this._options,e)},getOptions:function(){return $.extend(!0,{},this._options)},getValue:function(){return this._options.readonly?this._value:$("#coreui-form-"+this._id).val()},setValue:function(t){["string","number"].indexOf(c(t))<0||(this._value=t,this._options.readonly)||$("#coreui-form-"+this._id).val(t)},render:function(){return ejs.render(f["form-field-content.html"],{content:this.renderContent()})},renderContent:function(){var i=[],t=this.getOptions();return t.hasOwnProperty("attr")&&"object"===c(t.attr)&&null!==t.attr&&!Array.isArray(t.attr)||(t.attr={}),t.attr.id="coreui-form-"+this._id,t.name&&(t.attr.name=t.name),t.attr.type="hidden",t.attr.value=null!==this._value?this._value:"",$.each(t.attr,function(t,e){i.push(t+'="'+e+'"')}),ejs.render(f["fields/hidden.html"],{value:null!==this._value?this._value:"",field:t,render:{attr:0<i.length?" "+i.join(" "):""}})}},o.fields.input={_id:"",_hash:"",_form:null,_index:0,_value:"",_options:{type:"text",name:null,label:null,labelWidth:null,width:null,outContent:null,description:null,errorText:null,attach:null,attr:{class:"form-control d-inline-block"},required:null,invalidText:null,validText:null,readonly:null,datalist:null,show:!0,column:null},init:function(t,e,i){this._form=t,this._index=i,this._id=t.getId()+"-field-"+(e.hasOwnProperty("name")?e.name:i),this._hash=g.hashCode(),this._value=g.getFieldValue(t,e),this._options=g.mergeFieldOptions(t,this._options,e)},getOptions:function(){return $.extend(!0,{},this._options)},readonly:function(t){this._value=this.getValue(),this._options.readonly=!!t,$(".content-"+this._hash).html(this.renderContent())},hide:function(t){$("#coreui-form-"+this._id).hide(t)},show:function(t){$("#coreui-form-"+this._id).show(t)},getValue:function(){return this._options.readonly?this._value:$(".content-"+this._hash+" input").val()},setValue:function(t){["string","number"].indexOf(c(t))<0||(this._value=t,this._options.readonly?$(".content-"+this._hash).text(t):$(".content-"+this._hash+" input").val(t))},validate:function(t,e){var i,n;this._options.readonly||(i=$(".content-"+this._hash),n=$("input",i),i.find(".valid-feedback").remove(),i.find(".invalid-feedback").remove(),null===t?(n.removeClass("is-invalid"),n.removeClass("is-valid")):t?(n.removeClass("is-invalid"),n.addClass("is-valid"),"string"==typeof(e=void 0===e&&"string"==typeof this._options.validText?this._options.validText:e)&&i.append('<div class="valid-feedback">'+e+"</div>")):(n.removeClass("is-valid"),n.addClass("is-invalid"),void 0===e&&("string"==typeof this._options.invalidText?e=this._options.invalidText:!e&&this._options.required&&(e=this._form.getLang().required_field)),"string"==typeof e&&i.append('<div class="invalid-feedback">'+e+"</div>")))},isValid:function(){var t=$(".content-"+this._hash+" input");return t[0]?t.is(":valid"):null},render:function(){var t=this.getOptions(),e=g.getAttacheFields(this._form,t);return ejs.render(f["form-field-label.html"],{id:this._id,form:this._form,hash:this._hash,field:t,content:this.renderContent(),attachFields:e})},renderContent:function(){return this._options.readonly?this._renderContentReadonly():this._renderContent()},_renderContent:function(){var i=[],n=[],t=this.getOptions(),e=g.hashCode();return t.hasOwnProperty("attr")&&"object"===c(t.attr)&&null!==t.attr&&!Array.isArray(t.attr)||(t.attr={}),t.name&&(t.attr.name=this._options.name),t.attr.type=t.type,t.attr.value=null!==this._value?this._value:"",t.width&&(t.attr=g.mergeAttr({style:"width:"+t.width},t.attr)),t.required&&(t.attr.required="required"),t.hasOwnProperty("datalist")&&"object"===c(t.datalist)&&Array.isArray(t.datalist)&&(t.attr.list=e,$.each(t.datalist,function(t,e){var i=[];$.each(e,function(t,e){i.push(t+'="'+e+'"')}),n.push({attr:0<i.length?" "+i.join(" "):""})})),$.each(t.attr,function(t,e){i.push(t+'="'+e+'"')}),ejs.render(f["fields/input.html"],{field:t,datalistId:e,value:null!==this._value?this._value:"",render:{attr:0<i.length?" "+i.join(" "):"",datalist:n}})},_renderContentReadonly:function(){var t=this.getOptions(),e="text",i=this._value,n=this._form.getLang();t.hasOwnProperty("type")&&"string"==typeof t.type&&(e=t.type);try{switch(e){case"date":i=g.formatDate(i);break;case"datetime-local":i=g.formatDateTime(i);break;case"month":i=g.formatDateMonth(i,n);break;case"week":i=g.formatDateWeek(i,n)}}catch(t){console.error(t)}return ejs.render(f["fields/input.html"],{field:t,value:i,hash:this._hash})}},t=function(r){function a(h,y,b){var o,w={invalid:[],getCaret:function(){try{var t,e=0,i=h.get(0),n=document.selection,o=i.selectionStart;return n&&-1===navigator.appVersion.indexOf("MSIE 10")?((t=n.createRange()).moveStart("character",-w.val().length),e=t.text.length):!o&&"0"!==o||(e=o),e}catch(t){}},setCaret:function(t){try{var e,i;h.is(":focus")&&((i=h.get(0)).setSelectionRange?i.setSelectionRange(t,t):((e=i.createTextRange()).collapse(!0),e.moveEnd("character",t),e.moveStart("character",t),e.select()))}catch(t){}},events:function(){h.on("keydown.mask",function(t){h.data("mask-keycode",t.keyCode||t.which),h.data("mask-previus-value",h.val()),h.data("mask-previus-caret-pos",w.getCaret()),w.maskDigitPosMapOld=w.maskDigitPosMap}).on(r.jMaskGlobals.useInput?"input.mask":"keyup.mask",w.behaviour).on("paste.mask drop.mask",function(){setTimeout(function(){h.keydown().keyup()},100)}).on("change.mask",function(){h.data("changed",!0)}).on("blur.mask",function(){s===w.val()||h.data("changed")||h.trigger("change"),h.data("changed",!1)}).on("blur.mask",function(){s=w.val()}).on("focus.mask",function(t){!0===b.selectOnFocus&&r(t.target).select()}).on("focusout.mask",function(){b.clearIfNotMatch&&!o.test(w.val())&&w.val("")})},getRegexMask:function(){for(var t,e,i,n,o,s=[],r=0;r<y.length;r++)(i=x.translation[y.charAt(r)])?(t=i.pattern.toString().replace(/.{1}$|^.{1}/g,""),e=i.optional,(i=i.recursive)?(s.push(y.charAt(r)),n={digit:y.charAt(r),pattern:t}):s.push(e||i?t+"?":t)):s.push(y.charAt(r).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"));return o=s.join(""),n&&(o=o.replace(new RegExp("("+n.digit+"(.*"+n.digit+")?)"),"($1)?").replace(new RegExp(n.digit,"g"),n.pattern)),new RegExp(o)},destroyEvents:function(){h.off(["input","keydown","keyup","paste","drop","blur","focusout",""].join(".mask "))},val:function(t){var e=h.is("input")?"val":"text",t=0<arguments.length?(h[e]()!==t&&h[e](t),h):h[e]();return t},calculateCaretPosition:function(t){var e=w.getMasked(),i=w.getCaret();if(t!==e){for(var n=h.data("mask-previus-caret-pos")||0,o=e.length,e=t.length,s=0,r=0,a=0,l=0,d=0,d=i;d<o&&w.maskDigitPosMap[d];d++)r++;for(d=i-1;0<=d&&w.maskDigitPosMap[d];d--)s++;for(d=i-1;0<=d;d--)w.maskDigitPosMap[d]&&a++;for(d=n-1;0<=d;d--)w.maskDigitPosMapOld[d]&&l++;e<i?i=10*o:i<=n&&n!==e?w.maskDigitPosMapOld[i]||(t=i,w.maskDigitPosMap[i=i-(l-a)-s]&&(i=t)):n<i&&(i=i+(a-l)+r)}return i},behaviour:function(t){t=t||window.event,w.invalid=[];var e,i,n=h.data("mask-keycode");if(-1===r.inArray(n,x.byPassKeys))return n=w.getMasked(),e=w.getCaret(),i=h.data("mask-previus-value")||"",setTimeout(function(){w.setCaret(w.calculateCaretPosition(i))},r.jMaskGlobals.keyStrokeCompensation),w.val(n),w.setCaret(e),w.callbacks(t)},getMasked:function(t,e){for(var i,n,o=[],s=void 0===e?w.val():e+"",r=0,a=y.length,l=0,d=s.length,h=1,u="push",c=-1,f=0,p=[],_=b.reverse?(u="unshift",h=-1,i=0,r=a-1,l=d-1,function(){return-1<r&&-1<l}):(i=a-1,function(){return r<a&&l<d});_();){var m=y.charAt(r),v=s.charAt(l),g=x.translation[m];g?(v.match(g.pattern)?(o[u](v),g.recursive&&(-1===c?c=r:r===i&&r!==c&&(r=c-h),i===c)&&(r-=h),r+=h):v===n?(f--,n=void 0):g.optional?(r+=h,l-=h):g.fallback?(o[u](g.fallback),r+=h,l-=h):w.invalid.push({p:l,v:v,e:g.pattern}),l+=h):(t||o[u](m),v===m?(p.push(l),l+=h):(n=m,p.push(l+f),f++),r+=h)}e=y.charAt(i),a!==d+1||x.translation[e]||o.push(e),e=o.join("");return w.mapMaskdigitPositions(e,p,d),e},mapMaskdigitPositions:function(t,e,i){var n=b.reverse?t.length-i:0;w.maskDigitPosMap={};for(var o=0;o<e.length;o++)w.maskDigitPosMap[e[o]+n]=1},callbacks:function(t){function e(t,e,i){"function"==typeof b[t]&&e&&b[t].apply(this,i)}var i=w.val(),n=i!==s,o=[i,t,h,b];e("onChange",!0==n,o),e("onKeyPress",!0==n,o),e("onComplete",i.length===y.length,o),e("onInvalid",0<w.invalid.length,[i,t,h,w.invalid,b])}},x=(h=r(h),this),s=w.val();y="function"==typeof y?y(w.val(),void 0,h,b):y,x.mask=y,x.options=b,x.remove=function(){var t=w.getCaret();return x.options.placeholder&&h.removeAttr("placeholder"),h.data("mask-maxlength")&&h.removeAttr("maxlength"),w.destroyEvents(),w.val(x.getCleanVal()),w.setCaret(t),h},x.getCleanVal=function(){return w.getMasked(!0)},x.getMaskedVal=function(t){return w.getMasked(!1,t)},x.init=function(t){if(t=t||!1,b=b||{},x.clearIfNotMatch=r.jMaskGlobals.clearIfNotMatch,x.byPassKeys=r.jMaskGlobals.byPassKeys,x.translation=r.extend({},r.jMaskGlobals.translation,b.translation),x=r.extend(!0,{},x,b),o=w.getRegexMask(),t)w.events(),w.val(w.getMasked());else{b.placeholder&&h.attr("placeholder",b.placeholder),h.data("mask")&&h.attr("autocomplete","off");for(var e=0,i=!0;e<y.length;e++){var n=x.translation[y.charAt(e)];if(n&&n.recursive){i=!1;break}}i&&h.attr("maxlength",y.length).data("mask-maxlength",!0),w.destroyEvents(),w.events();t=w.getCaret();w.val(w.getMasked()),w.setCaret(t)}},x.init(!h.is("input"))}function e(){var t=r(this),e={},i="data-mask-",n=t.attr("data-mask");if(t.attr(i+"reverse")&&(e.reverse=!0),t.attr(i+"clearifnotmatch")&&(e.clearIfNotMatch=!0),"true"===t.attr(i+"selectonfocus")&&(e.selectOnFocus=!0),l(t,n,e))return t.data("mask",new a(this,n,e))}function l(t,e,i){i=i||{};var n=r(t).data("mask"),o=JSON.stringify,t=r(t).val()||r(t).text();try{return"function"==typeof e&&(e=e(t)),"object"!=typeof n||o(n.options)!==o(i)||n.mask!==e}catch(t){}}r.maskWatchers={};r.fn.mask=function(t,e){e=e||{};function i(){if(l(this,t,e))return r(this).data("mask",new a(this,t,e))}var n=this.selector,o=r.jMaskGlobals,s=o.watchInterval,o=e.watchInputs||o.watchInputs;return r(this).each(i),n&&""!==n&&o&&(clearInterval(r.maskWatchers[n]),r.maskWatchers[n]=setInterval(function(){r(document).find(n).each(i)},s)),this},r.fn.masked=function(t){return this.data("mask").getMaskedVal(t)},r.fn.unmask=function(){return clearInterval(r.maskWatchers[this.selector]),delete r.maskWatchers[this.selector],this.each(function(){var t=r(this).data("mask");t&&t.remove().removeData("mask")})},r.fn.cleanVal=function(){return this.data("mask").getCleanVal()},r.applyDataMask=function(t){((t=t||r.jMaskGlobals.maskElements)instanceof r?t:r(t)).filter(r.jMaskGlobals.dataMaskAttr).each(e)};var t,i,n={maskElements:"input,td,span,div",dataMaskAttr:"*[data-mask]",dataMask:!0,watchInterval:300,watchInputs:!0,keyStrokeCompensation:10,useInput:!/Chrome\/[2-4][0-9]|SamsungBrowser/.test(window.navigator.userAgent)&&(n="input",i=document.createElement("div"),(t=(n="on"+n)in i)||(i.setAttribute(n,"return;"),t="function"==typeof i[n]),i=null,t),watchDataMask:!1,byPassKeys:[9,16,17,18,36,37,38,39,40,91],translation:{0:{pattern:/\d/},9:{pattern:/\d/,optional:!0},"#":{pattern:/\d/,recursive:!0},A:{pattern:/[a-zA-Z0-9]/},S:{pattern:/[a-zA-Z]/}}};r.jMaskGlobals=r.jMaskGlobals||{},(n=r.jMaskGlobals=r.extend(!0,{},n,r.jMaskGlobals)).dataMask&&r.applyDataMask(),setInterval(function(){r.jMaskGlobals.watchDataMask&&r.applyDataMask()},n.watchInterval)},e=window.jQuery,i=window.Zepto,"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports&&"undefined"==typeof Meteor?module.exports=t(require("jquery")):t(e||i),o.fields.mask={_id:"",_hash:"",_form:null,_index:0,_value:"",_options:{type:"mask",name:null,label:null,labelWidth:null,width:null,outContent:null,description:null,errorText:null,attach:null,attr:{class:"form-control d-inline-block"},required:null,readonly:null,datalist:null,show:!0,column:null},init:function(t,e,i){this._form=t,this._index=i,this._id=t.getId()+"-field-"+(e.hasOwnProperty("name")?e.name:i),this._value=g.getFieldValue(t,e),this._options=g.mergeFieldOptions(t,this._options,e),this._hash=g.hashCode();var n=this;t.on("show",function(){n._options.readonly||n._initEvents()})},getOptions:function(){return $.extend(!0,{},this._options)},readonly:function(t){this._value=this.getValue(),this._options.readonly=!!t,$(".content-"+this._hash).html(this.renderContent()),this._options.readonly||this._initEvents()},hide:function(t){$("#coreui-form-"+this._id).hide(t)},show:function(t){$("#coreui-form-"+this._id).show(t)},getValue:function(){return this._options.readonly?this._value:$(".content-"+this._hash+" input").val()},setValue:function(t){["string","number"].indexOf(c(t))<0||(t=t.replace(/[^\d\w]/g,""),this._value=t,this._options.readonly?$(".content-"+this._hash).text(t):$(".content-"+this._hash+" input").val(t))},validate:function(t,e){var i,n;this._options.readonly||(i=$(".content-"+this._hash),n=$("input",i),i.find(".valid-feedback").remove(),i.find(".invalid-feedback").remove(),null===t?(n.removeClass("is-invalid"),n.removeClass("is-valid")):t?(n.removeClass("is-invalid"),n.addClass("is-valid"),"string"==typeof(e=void 0===e&&"string"==typeof this._options.validText?this._options.validText:e)&&i.append('<div class="valid-feedback">'+e+"</div>")):(n.removeClass("is-valid"),n.addClass("is-invalid"),void 0===e&&("string"==typeof this._options.invalidText?e=this._options.invalidText:!e&&this._options.required&&(e=this._form.getLang().required_field)),"string"==typeof e&&i.append('<div class="invalid-feedback">'+e+"</div>")))},isValid:function(){var t=$(".content-"+this._hash+" input");return t[0]?t.is(":valid"):null},render:function(){var t=this.getOptions(),e=g.getAttacheFields(this._form,t);return ejs.render(f["form-field-label.html"],{id:this._id,form:this._form,hash:this._hash,field:t,content:this.renderContent(),attachFields:e})},renderContent:function(){return this._options.readonly?this._renderContentReadonly():this._renderContent()},_renderContent:function(){var i=[],n=[],t=this.getOptions(),e=g.hashCode();return t.hasOwnProperty("attr")&&"object"===c(t.attr)&&null!==t.attr&&!Array.isArray(t.attr)||(t.attr={}),t.name&&(t.attr.name=this._options.name),t.attr.type="text",t.attr.value=null!==this._value?this._value:"",t.width&&(t.attr=g.mergeAttr({style:"width:"+t.width},t.attr)),t.required&&(t.attr.required="required"),t.hasOwnProperty("datalist")&&"object"===c(t.datalist)&&Array.isArray(t.datalist)&&(t.attr.list=e,$.each(t.datalist,function(t,e){var i=[];$.each(e,function(t,e){i.push(t+'="'+e+'"')}),n.push({attr:0<i.length?" "+i.join(" "):""})})),$.each(t.attr,function(t,e){i.push(t+'="'+e+'"')}),ejs.render(f["fields/input.html"],{field:t,datalistId:e,value:null!==this._value?this._value:"",render:{attr:0<i.length?" "+i.join(" "):"",datalist:n}})},_renderContentReadonly:function(){var t=this.getOptions();return ejs.render(f["fields/input.html"],{field:t,value:null!==this._value?this._value:""})},_initEvents:function(){$("#coreui-form-"+this._id+" .content-"+this._hash+" input").mask(this._options.mask,this._options.options)}},o.fields.modal={_id:"",_hash:"",_form:null,_value:"",_text:"",_options:{type:"modal",name:null,label:null,labelWidth:null,width:null,outContent:null,description:null,errorText:null,fields:[],options:{title:"",size:"lg",url:"",onHidden:null,onClear:null,onChange:null},required:null,readonly:null,show:!0,column:null},init:function(t,e,i){var n=t.getRecord(),o=(this._form=t,this._id=t.getId()+"-field-"+(e.hasOwnProperty("name")?e.name:i),this._options=g.mergeFieldOptions(t,this._options,e),this._hash=g.hashCode(),"string"==typeof e.name&&n.hasOwnProperty(e.name)&&0<=["object"].indexOf(c(n[e.name]))&&(i=n[e.name],this._value=i.hasOwnProperty("value")&&0<=["number","string"].indexOf(c(i.value))?i.value:"",this._text=i.hasOwnProperty("text")&&0<=["number","string"].indexOf(c(i.text))?i.text:""),this);t.on("show",function(){o._initEvents()})},getOptions:function(){return $.extend(!0,{},this._options)},readonly:function(t){this._value=this.getValue(),this._options.readonly=!!t,$(".content-"+this._hash).html(this.renderContent()),this._options.readonly||this._initEvents()},hide:function(t){$("#coreui-form-"+this._id).hide(t)},show:function(t){$("#coreui-form-"+this._id).show(t)},getValue:function(){return this._options.readonly?this._value:$(".content-"+this._hash+" input.coreui-form-modal-value").val()},setValue:function(t,e){var i,n,o;["string","number"].indexOf(c(t))<0||(this._value=t,this._options.readonly?$(".content-"+this._hash).text(e):(o=$(".content-"+this._hash+" .coreui-form-modal-value"),i=$(".content-"+this._hash+" .coreui-form-modal-text"),n=o.val(),o.val(t),i.val(e),n!=t&&((o=this._options.hasOwnProperty("options")&&"object"===c(this._options.options)?this._options.options:{}).hasOwnProperty("onChange")&&("function"==typeof o.onChange?o.onChange(this):"string"==typeof o.onChange&&new Function("modal",o.onChange)(this)),p(this._form,"change-modal.coreui.form",[this],this))))},validate:function(t,e){var i;this._options.readonly||((i=$(".content-"+this._hash)).find(".text-success").remove(),i.find(".text-danger").remove(),null!==t&&(t?"string"==typeof(e=void 0===e&&"string"==typeof this._options.validText?this._options.validText:e)&&i.append('<div class="ps-2 text-success">'+e+"</div>"):(void 0===e&&("string"==typeof this._options.invalidText?e=this._options.invalidText:!e&&this._options.required&&(e=this._form.getLang().required_field)),"string"==typeof e&&i.append('<div class="ps-2 text-danger">'+e+"</div>"))))},isValid:function(){return!(this._options.required&&!this._options.readonly&&!this.getValue())},render:function(){var t=this.getOptions(),e=g.getAttacheFields(this._form,t);return ejs.render(f["form-field-label.html"],{id:this._id,form:this._form,hash:this._hash,field:t,content:this.renderContent(),attachFields:e})},renderContent:function(){var t=this.getOptions(),i=[],e={type:"text",readonly:"readonly",class:"form-control coreui-form-modal-text",value:null!==this._text?this._text:""};return t.required&&(e.required="required"),t.hasOwnProperty("attr")&&"object"===c(t.attr)&&Array.isArray(t.attr)&&(e=g.mergeAttr(e,t.attr)),$.each(e,function(t,e){i.push(t+'="'+e+'"')}),ejs.render(f["fields/modal.html"],{field:t,value:null!==this._value?this._value:"",text:null!==this._text?this._text:"",lang:this._form.getLang(),render:{width:this._options.width,attr:0<i.length?i.join(" "):""}})},_initEvents:function(){var l=this,d=this._options.hasOwnProperty("options")&&"object"===c(this._options.options)?this._options.options:{};$(".content-"+this._hash+" .btn-modal-clear").click(function(t){d.hasOwnProperty("onClear")&&("function"==typeof d.onClear?d.onClear(l):"string"==typeof d.onClear&&new Function("field",d.onClear)(l)),p(l._form,"modal_clear",[l,t],l),l.setValue("","")}),$(".content-"+this._hash+" .btn-modal-select").click(function(t){var e,i,n,o,s=d.hasOwnProperty("title")&&"string"==typeof d.title?d.title:"",r=d.hasOwnProperty("size")&&"string"==typeof d.size?d.size:"lg",a=d.hasOwnProperty("url")&&"string"==typeof d.url?d.url:"";a&&(e=g.hashCode(),i=ejs.render(f["fields/modal-loading.html"],{lang:l._form.getLang()}),CoreUI.hasOwnProperty("modal")&&(o=n=null,d.hasOwnProperty("onHidden")&&("function"==typeof d.onHidden?o=d.onHidden:"string"==typeof d.onHidden&&(o=new Function(d.onHidden))),d.hasOwnProperty("onShow")&&("function"==typeof d.onShow?n=d.onShow:"string"==typeof d.onShow&&(n=new Function(d.onShow))),CoreUI.modal.show(s,i,{id:e,size:r,onShow:n,onHidden:o})),$.ajax({url:a,method:"GET",beforeSend:function(t){p(l._form,"modal_load_before",[l,t],l)},success:function(t){$("#modal-"+e+" .modal-body").html(t),p(l._form,"modal_load_success",[l,t],l)},error:function(t,e,i){p(l._form,"modal_load_error",[l,t,e,i],l)},complete:function(t,e){p(l._form,"modal_load_complete",[l,t,e],l)}}),p(l._form,"modal_select",[l,t],l))})}},o.fields.number={_id:"",_hash:"",_form:null,_index:0,_value:"",_options:{type:"number",name:null,label:null,labelWidth:null,width:null,outContent:null,description:null,errorText:null,attach:null,attr:{class:"form-control d-inline-block",step:"any"},required:null,readonly:null,datalist:null,show:!0,column:null,precision:null},init:function(t,e,i){this._form=t,this._index=i,this._id=t.getId()+"-field-"+(e.hasOwnProperty("name")?e.name:i),this._hash=g.hashCode(),this._value=g.getFieldValue(t,e),this._options=g.mergeFieldOptions(t,this._options,e),null===this._options.precision&&(i=0,this._options.attr.hasOwnProperty("step")&&"any"!==this._options.attr.step&&0<=["string","number"].indexOf(c(this._options.attr.step))&&(e=$.trim(this._options.attr.step.toString()).match(/\.(\d+)$/))&&e.hasOwnProperty(1)&&(i=e?e[1].length:i),this._options.precision=i);var n=this;t.on("show",function(){n._options.readonly||n._initEvents()})},getOptions:function(){return $.extend(!0,{},this._options)},readonly:function(t){this._value=this.getValue(),this._options.readonly=!!t,$(".content-"+this._hash).html(this.renderContent()),this._options.readonly||this._initEvents()},hide:function(t){$("#coreui-form-"+this._id).hide(t)},show:function(t){$("#coreui-form-"+this._id).show(t)},getValue:function(){return this._options.readonly?this._value:$(".content-"+this._hash+" input").val()},setValue:function(t){["string","number"].indexOf(c(t))<0||!t.toString().match(/^\-?\d+\.?\d*$/)||(0<=this._options.precision&&(t=g.round(t,this._options.precision)),this._options.attr.hasOwnProperty("min")&&(t=t<Number(this._options.attr.min)?Number(this._options.attr.min):t),this._options.attr.hasOwnProperty("max")&&(t=t>Number(this._options.attr.max)?Number(this._options.attr.max):t),this._value=t,this._options.readonly?$(".content-"+this._hash).text(t):$(".content-"+this._hash+" input").val(t))},validate:function(t,e){var i,n;this._options.readonly||(i=$(".content-"+this._hash),n=$("input",i),i.find(".valid-feedback").remove(),i.find(".invalid-feedback").remove(),null===t?(n.removeClass("is-invalid"),n.removeClass("is-valid")):t?(n.removeClass("is-invalid"),n.addClass("is-valid"),"string"==typeof(e=void 0===e&&"string"==typeof this._options.validText?this._options.validText:e)&&i.append('<div class="valid-feedback">'+e+"</div>")):(n.removeClass("is-valid"),n.addClass("is-invalid"),void 0===e&&("string"==typeof this._options.invalidText?e=this._options.invalidText:!e&&this._options.required&&(e=this._form.getLang().required_field)),"string"==typeof e&&i.append('<div class="invalid-feedback">'+e+"</div>")))},isValid:function(){var t=$(".content-"+this._hash+" input");return t[0]?t.is(":valid"):null},render:function(){var t=$.extend(!0,{},this._options),e=g.getAttacheFields(this._form,t);return ejs.render(f["form-field-label.html"],{id:this._id,form:this._form,hash:this._hash,field:t,content:this.renderContent(),attachFields:e})},renderContent:function(){var i=[],n=[],t=this.getOptions(),e=g.hashCode();return t.hasOwnProperty("attr")&&"object"===c(t.attr)&&null!==t.attr&&!Array.isArray(t.attr)||(t.attr={}),t.name&&(t.attr.name=this._options.name),t.attr.type="number",t.attr.value=null!==this._value?this._value:"",t.width&&(t.attr=g.mergeAttr({style:"width:"+t.width},t.attr)),t.required&&(t.attr.required="required"),t.hasOwnProperty("datalist")&&"object"===c(t.datalist)&&Array.isArray(t.datalist)&&(t.attr.list=e,$.each(t.datalist,function(t,e){var i=[];$.each(e,function(t,e){i.push(t+'="'+e+'"')}),n.push({attr:0<i.length?" "+i.join(" "):""})})),$.each(t.attr,function(t,e){i.push(t+'="'+e+'"')}),ejs.render(f["fields/input.html"],{field:t,datalistId:e,value:null!==this._value?this._value:"",render:{attr:0<i.length?" "+i.join(" "):"",datalist:n}})},_initEvents:function(){$(".content-"+this._hash+" input").keydown(function(t){var e=t.keyCode||t.which;(!(35<=e&&e<=40||96<=e&&e<=105||189===e||109===e||110===e||190===e||9===e||46===e||8===e||!t.shiftKey&&48<=e&&e<=57)||t.ctrlKey&&t.altKey)&&t.preventDefault()});var i=this;$(".content-"+this._hash+" input").blur(function(t){var e=$(this).val();0<=i._options.precision&&(e=g.round(e,i._options.precision)),i._options.attr.hasOwnProperty("min")&&(e=e<Number(i._options.attr.min)?Number(i._options.attr.min):e),i._options.attr.hasOwnProperty("max")&&(e=e>Number(i._options.attr.max)?Number(i._options.attr.max):e),$(this).val(e)})}},o.fields.radio={_id:"",_hash:"",_form:null,_index:0,_value:"",_options:{type:"radio",name:null,label:null,labelWidth:null,inline:!1,outContent:null,description:null,errorText:null,options:[],fields:[],required:null,readonly:null,show:!0,column:null},init:function(t,e,i){this._form=t,this._id=t.getId()+"-field-"+(e.hasOwnProperty("name")?e.name:i),this._hash=g.hashCode(),this._value=g.getFieldValue(t,e),this._options=g.mergeFieldOptions(t,this._options,e)},getOptions:function(){return $.extend(!0,{},this._options)},readonly:function(t){this._value=this.getValue(),this._options.readonly=!!t,$(".content-"+this._hash).html(this.renderContent())},hide:function(t){$("#coreui-form-"+this._id).hide(t)},show:function(t){$("#coreui-form-"+this._id).show(t)},getValue:function(){return this._options.readonly?this._value:$(".content-"+this._hash+" input[type=radio]:checked").val()},setValue:function(i){var n,t;["string","number"].indexOf(c(i))<0||(this._options.readonly?(t=(n=this).getOptions()).hasOwnProperty("options")&&"object"===c(t.options)&&Array.isArray(t.options)&&$.each(t.options,function(t,e){if(e.hasOwnProperty("value")&&e.value==i)return e=e.hasOwnProperty("text")&&0<=["string","number"].indexOf(c(e.text))?e.text:"",$(".content-"+n._hash).text(e),n._value=i,!1}):(t=$(".content-"+this._hash+' input[type=radio][value="'+i+'"]'))[0]&&(t.prop("checked",!0),this._value=i))},validate:function(t,e){var i,n,o;this._options.readonly||(i=$(".content-"+this._hash),n=$(".form-check:last-child",i),o=$("input",i),i.find(".valid-feedback").remove(),i.find(".invalid-feedback").remove(),null===t?(o.removeClass("is-invalid"),o.removeClass("is-valid")):t?(o.removeClass("is-invalid"),o.addClass("is-valid"),"string"==typeof(e=void 0===e&&"string"==typeof this._options.validText?this._options.validText:e)&&n.append('<div class="valid-feedback">'+e+"</div>")):(o.removeClass("is-valid"),o.addClass("is-invalid"),void 0===e&&("string"==typeof this._options.invalidText?e=this._options.invalidText:!e&&this._options.required&&(e=this._form.getLang().required_field)),"string"==typeof e&&n.append('<div class="invalid-feedback">'+e+"</div>")))},isValid:function(){var t;return!(this._options.required&&!this._options.readonly)||"string"==typeof(t=this.getValue())&&""!==t},render:function(){var t=this.getOptions(),t=g.getAttacheFields(this._form,t);return ejs.render(f["form-field-label.html"],{id:this._id,form:this._form,hash:this._hash,field:this._options,content:this.renderContent(),attachFields:t})},renderContent:function(){var s=this,r=[],a=this.getOptions(),l=[];return a.hasOwnProperty("options")&&"object"===c(a.options)&&Array.isArray(a.options)&&$.each(a.options,function(t,e){var i=[],n={type:"radio",class:"form-check-input"},o=e.hasOwnProperty("text")&&0<=["string","number"].indexOf(c(e.text))?e.text:"";a.name&&(n.name=s._options.name),a.required&&(n.required="required"),$.each(e,function(t,e){"text"!==t&&(n[t]="class"===t?n[t]+" "+e:e)}),n.id=g.hashCode(),s._value==e.value&&(e.hasOwnProperty("text")&&e.text&&l.push(e.text),n.checked="checked"),$.each(n,function(t,e){i.push(t+'="'+e+'"')}),r.push({id:n.id,text:o,attr:0<i.length?" "+i.join(" "):""})}),ejs.render(f["fields/radio.html"],{field:a,value:this._value,render:{options:r,selectedItem:l}})}},o.fields.range={_id:"",_hash:"",_form:null,_index:0,_value:"",_options:{type:"range",name:null,label:null,labelWidth:null,width:null,outContent:null,description:null,errorText:null,attach:null,attr:{class:"form-range d-inline-block pt-1"},required:null,readonly:null,datalist:null,show:!0,column:null},init:function(t,e,i){this._form=t,this._index=i,this._id=t.getId()+"-field-"+(e.hasOwnProperty("name")?e.name:i),this._hash=g.hashCode(),this._value=g.getFieldValue(t,e),this._options=g.mergeFieldOptions(t,this._options,e)},getOptions:function(){return $.extend(!0,{},this._options)},readonly:function(t){this._value=this.getValue(),this._options.readonly=!!t,$(".content-"+this._hash).html(this.renderContent())},hide:function(t){$("#coreui-form-"+this._id).hide(t)},show:function(t){$("#coreui-form-"+this._id).show(t)},getValue:function(){return this._options.readonly?this._value:$(".content-"+this._hash+" input").val()},setValue:function(t){["string","number"].indexOf(c(t))<0||(this._value=t,this._options.readonly?$(".content-"+this._hash).text(t):$(".content-"+this._hash+" input").val(t))},validate:function(t,e){var i,n;this._options.readonly||(i=$(".content-"+this._hash),n=$("input",i),i.find(".valid-feedback").remove(),i.find(".invalid-feedback").remove(),null===t?(n.removeClass("is-invalid"),n.removeClass("is-valid")):t?(n.removeClass("is-invalid"),n.addClass("is-valid"),"string"==typeof(e=void 0===e&&"string"==typeof this._options.validText?this._options.validText:e)&&i.append('<div class="valid-feedback">'+e+"</div>")):(n.removeClass("is-valid"),n.addClass("is-invalid"),void 0===e&&("string"==typeof this._options.invalidText?e=this._options.invalidText:!e&&this._options.required&&(e=this._form.getLang().required_field)),"string"==typeof e&&i.append('<div class="invalid-feedback">'+e+"</div>")))},isValid:function(){var t=$(".content-"+this._hash+" input");return t[0]?t.is(":valid"):null},render:function(){var t=this.getOptions(),e=g.getAttacheFields(this._form,t);return ejs.render(f["form-field-label.html"],{id:this._id,form:this._form,hash:this._hash,field:t,content:this.renderContent(),attachFields:e})},renderContent:function(){var i=[],n=[],t=this.getOptions(),e=g.hashCode();return t.hasOwnProperty("attr")&&"object"===c(t.attr)&&null!==t.attr&&!Array.isArray(t.attr)||(t.attr={}),t.name&&(t.attr.name=this._options.name),t.attr.type="range",t.attr.value=this._value,t.width&&(t.attr=g.mergeAttr({style:"width:"+t.width},t.attr)),t.required&&(t.attr.required="required"),t.hasOwnProperty("datalist")&&"object"===c(t.datalist)&&Array.isArray(t.datalist)&&(t.attr.list=e,$.each(t.datalist,function(t,e){var i=[];$.each(e,function(t,e){i.push(t+'="'+e+'"')}),n.push({attr:0<i.length?" "+i.join(" "):""})})),$.each(t.attr,function(t,e){i.push(t+'="'+e+'"')}),ejs.render(f["fields/input.html"],{field:t,datalistId:e,value:this._value,render:{attr:0<i.length?" "+i.join(" "):"",datalist:n}})}},o.fields.select={_id:"",_hash:"",_form:null,_index:0,_value:[],_options:{type:"select",name:null,label:null,labelWidth:null,width:null,outContent:null,description:null,errorText:null,attach:null,attr:{class:"form-select d-inline-block"},required:null,readonly:null,show:!0,column:null},init:function(t,e,i){this._form=t,this._index=i,this._id=t.getId()+"-field-"+(e.hasOwnProperty("name")?e.name:i),this._hash=g.hashCode(),this._value=g.getFieldValue(t,e),this._options=g.mergeFieldOptions(t,this._options,e)},getOptions:function(){return $.extend(!0,{},this._options)},readonly:function(t){this._value=this.getValue(),this._options.readonly=!!t,$(".content-"+this._hash).html(this.renderContent())},hide:function(t){$("#coreui-form-"+this._id).hide(t)},show:function(t){$("#coreui-form-"+this._id).show(t)},getValue:function(){var t;return this._options.readonly?this._value:this._options.hasOwnProperty("attr")&&"object"===c(this._options.attr)&&null!==this._options.attr&&!Array.isArray(this._options.attr)&&this._options.attr.hasOwnProperty("multiple")?(t=[],$(".content-"+this._hash+" select option:selected").each(function(){t.push($(this).val())}),t):$(".content-"+this._hash+" select option:selected").val()},setValue:function(e){if(!(["string","number","object"].indexOf(c(e))<0)){if("object"===c(e)){if(null!==e&&!Array.isArray(e))return}else e=[e];var t,n,o=this;this._value=[],this._options.readonly?($(".content-"+o._hash).empty(),(t=this.getOptions()).hasOwnProperty("options")&&"object"===c(t.options)&&Array.isArray(t.options)&&Array.isArray(e)&&(n=[],$.each(t.options,function(t,i){i.hasOwnProperty("value")&&$.each(e,function(t,e){if(i.value==e)return i.hasOwnProperty("text")&&0<=["string","number"].indexOf(c(i.text))&&n.push(i.text),o._value.push(e),!1})}),$(".content-"+o._hash).text(n.join(", ")))):($(".content-"+this._hash+" select > option").prop("selected",!1),Array.isArray(e)&&$(".content-"+this._hash+" select > option").each(function(t,i){$.each(e,function(t,e){if(e==$(i).val())return $(i).prop("selected",!0),o._value.push(e),!1})}))}},validate:function(t,e){var i,n;this._options.readonly||(i=$(".content-"+this._hash),n=$("select",i),i.find(".valid-feedback").remove(),i.find(".invalid-feedback").remove(),null===t?(n.removeClass("is-invalid"),n.removeClass("is-valid")):t?(n.removeClass("is-invalid"),n.addClass("is-valid"),"string"==typeof(e=void 0===e&&"string"==typeof this._options.validText?this._options.validText:e)&&i.append('<div class="valid-feedback">'+e+"</div>")):(n.removeClass("is-valid"),n.addClass("is-invalid"),void 0===e&&("string"==typeof this._options.invalidText?e=this._options.invalidText:!e&&this._options.required&&(e=this._form.getLang().required_field)),"string"==typeof e&&i.append('<div class="invalid-feedback">'+e+"</div>")))},isValid:function(){var t=$(".content-"+this._hash+" select");return(!this._options.required||""!==t.val())&&(t[0]?t.is(":valid"):null)},render:function(){var t=this.getOptions(),e=g.getAttacheFields(this._form,t);return ejs.render(f["form-field-label.html"],{id:this._id,form:this._form,hash:this._hash,field:t,content:this.renderContent(),attachFields:e})},renderContent:function(){return this._options.readonly?this._renderContentReadonly():this._renderContent()},_renderContent:function(){var o=this,t=this.getOptions(),i=[],s=[];return t.hasOwnProperty("attr")&&"object"===c(t.attr)&&null!==t.attr&&!Array.isArray(t.attr)||(t.attr={}),t.name&&(t.attr.name=this._options.name),t.width&&(t.attr=g.mergeAttr({style:"width:"+t.width},t.attr)),t.required&&(t.attr.required="required"),t.hasOwnProperty("options")&&"object"===c(t.options)&&null!==t.options&&$.each(t.options,function(t,e){var i,n;"string"==typeof e||"number"==typeof e?s.push(o._renderOption({type:"option",value:t,text:e})):"object"===c(e)&&("group"===(e.hasOwnProperty("type")&&"string"==typeof e.type?e.type:"option")?(i=[],t={},n=[],e.hasOwnProperty("attr")&&"object"===c(e.attr)&&null!==e.attr&&!Array.isArray(e.attr)&&(t=e.attr),e.hasOwnProperty("label")&&0<=["string","number"].indexOf(c(e.label))&&(t.label=e.label),$.each(t,function(t,e){i.push(t+'="'+e+'"')}),Array.isArray(e.options)&&$.each(e.options,function(t,e){n.push(o._renderOption(e))}),s.push({type:"group",attr:0<i.length?" "+i.join(" "):"",options:n})):s.push(o._renderOption(e)))}),$.each(t.attr,function(t,e){i.push(t+'="'+e+'"')}),ejs.render(f["fields/select.html"],{field:t,value:this._value,render:{attr:0<i.length?" "+i.join(" "):"",options:s}})},_renderContentReadonly:function(){var e=this,t=this.getOptions(),o=[];return t.hasOwnProperty("options")&&"object"===c(t.options)&&Array.isArray(t.options)&&$.each(t.options,function(t,i){var n;"group"===(i.hasOwnProperty("type")&&"string"==typeof i.type?i.type:"option")?Array.isArray(i.options)&&$.each(i.options,function(t,i){var n=i.hasOwnProperty("text")&&0<=["string","number"].indexOf(c(i.text))?i.text:"";n&&""!==n&&(Array.isArray(e._value)?$.each(e._value,function(t,e){if(e==i.value)return o.push(n),!1}):e._value==i.value&&o.push(n))}):(n=i.hasOwnProperty("text")&&0<=["string","number"].indexOf(c(i.text))?i.text:"")&&""!==n&&(Array.isArray(e._value)?$.each(e._value,function(t,e){if(e==i.value)return o.push(n),!1}):e._value==i.value&&o.push(n))}),ejs.render(f["fields/select.html"],{field:t,render:{selectedOptions:o}})},_renderOption:function(i){var n=[],t=i.hasOwnProperty("text")&&0<=["string","number"].indexOf(c(i.text))?i.text:"";return $.each(i,function(t,e){"text"!==t&&n.push(t+'="'+e+'"')}),Array.isArray(this._value)?$.each(this._value,function(t,e){if(e==i.value)return n.push('selected="selected"'),!1}):this._value==i.value&&n.push('selected="selected"'),{type:"option",text:t,attr:0<n.length?" "+n.join(" "):""}}},o.fields.switch={_id:"",_hash:"",_form:null,_index:0,_value:"",_options:{type:"switch",name:null,label:null,labelWidth:null,outContent:null,description:null,errorText:null,valueY:"Y",valueN:"N",fields:[],required:null,readonly:null,show:!0,column:null},init:function(t,e,i){this._form=t,this._index=i,this._id=t.getId()+"-field-"+(e.hasOwnProperty("name")?e.name:i),this._hash=g.hashCode(),this._value=g.getFieldValue(t,e),this._options=g.mergeFieldOptions(t,this._options,e)},getOptions:function(){return $.extend(!0,{},this._options)},readonly:function(t){this._value=this.getValue(),this._options.readonly=!!t,$(".content-"+this._hash).html(this.renderContent())},hide:function(t){$("#coreui-form-"+this._id).hide(t)},show:function(t){$("#coreui-form-"+this._id).show(t)},getValue:function(){var t=this._options.readonly?this._value:$(".content-"+this._hash+" input").prop("checked")?this._options.valueY:this._options.valueN;return t},setValue:function(t){["string","number"].indexOf(c(t))<0||(this._value=t,this._options.readonly?$(".content-"+this._hash).text(t):$(".content-"+this._hash+" input[type=checkbox]").prop("checked",t===this._options.valueY))},validate:function(t,e){var i,n,o;this._options.readonly||(i=$(".content-"+this._hash),n=$(".form-switch",i),o=$("input",i),i.find(".valid-feedback").remove(),i.find(".invalid-feedback").remove(),null===t?(o.removeClass("is-invalid"),o.removeClass("is-valid")):t?(o.removeClass("is-invalid"),o.addClass("is-valid"),"string"==typeof(e=void 0===e&&"string"==typeof this._options.validText?this._options.validText:e)&&n.append('<div class="valid-feedback">'+e+"</div>")):(o.removeClass("is-valid"),o.addClass("is-invalid"),"string"==typeof(e=void 0===e?"string"==typeof this._options.invalidText?this._options.invalidText:e||this._form.getLang().required_field:e)&&n.append('<div class="invalid-feedback">'+e+"</div>")))},isValid:function(){return null},render:function(){var t=this.getOptions(),e=g.getAttacheFields(this._form,t);return ejs.render(f["form-field-label.html"],{id:this._id,form:this._form,hash:this._hash,field:t,content:this.renderContent(),attachFields:e})},renderContent:function(){var i=[],t=this.getOptions(),e={type:"checkbox",class:"form-check-input",value:t.valueY};return t.name&&(e.name=this._options.name),t.required&&(e.required="required"),t.hasOwnProperty("attr")&&"object"===c(t.attr)&&Array.isArray(t.attr)&&(e=g.mergeAttr(e,t.attr)),this._value===t.valueY&&(e.checked="checked"),$.each(e,function(t,e){i.push(t+'="'+e+'"')}),ejs.render(f["fields/switch.html"],{field:t,value:this._value,lang:this._form.getLang(),render:{attr:0<i.length?i.join(" "):""}})}},o.fields.textarea={_id:"",_form:null,_index:0,_value:"",_options:{type:"textarea",name:null,label:null,labelWidth:null,width:null,outContent:null,description:null,errorText:null,attach:null,attr:{class:"form-control d-inline-block"},required:null,readonly:null,show:!0,column:null},init:function(t,e,i){this._form=t,this._index=i,this._id=t.getId()+"-field-"+(e.hasOwnProperty("name")?e.name:i),this._hash=g.hashCode(),this._value=g.getFieldValue(t,e),this._options=g.mergeFieldOptions(t,this._options,e)},getOptions:function(){return $.extend(!0,{},this._options)},readonly:function(t){this._value=this.getValue(),this._options.readonly=!!t,$(".content-"+this._hash).html(this.renderContent())},hide:function(t){$("#coreui-form-"+this._id).hide(t)},show:function(t){$("#coreui-form-"+this._id).show(t)},getValue:function(){return this._options.readonly?this._value:$(".content-"+this._hash+" textarea").val()},setValue:function(t){["string","number"].indexOf(c(t))<0||(this._value=t,this._options.readonly?$(".content-"+this._hash).text(t):$(".content-"+this._hash+" textarea").val(t))},validate:function(t,e){var i,n;this._options.readonly||(i=$(".content-"+this._hash),n=$("textarea",i),i.find(".valid-feedback").remove(),i.find(".invalid-feedback").remove(),null===t?(n.removeClass("is-invalid"),n.removeClass("is-valid")):t?(n.removeClass("is-invalid"),n.addClass("is-valid"),"string"==typeof(e=void 0===e&&"string"==typeof this._options.validText?this._options.validText:e)&&i.append('<div class="valid-feedback">'+e+"</div>")):(n.removeClass("is-valid"),n.addClass("is-invalid"),void 0===e&&("string"==typeof this._options.invalidText?e=this._options.invalidText:!e&&this._options.required&&(e=this._form.getLang().required_field)),"string"==typeof e&&i.append('<div class="invalid-feedback">'+e+"</div>")))},isValid:function(){var t=$(".content-"+this._hash+" textarea");if(t[0])return t.is(":valid")},render:function(){var t=this.getOptions(),e=g.getAttacheFields(this._form,t);return ejs.render(f["form-field-label.html"],{id:this._id,form:this._form,hash:this._hash,field:t,content:this.renderContent(),attachFields:e})},renderContent:function(){var i=[],t=this.getOptions();return t.hasOwnProperty("attr")&&"object"===c(t.attr)&&null!==t.attr&&!Array.isArray(t.attr)||(t.attr={}),t.name&&(t.attr.name=this._options.name),t.width&&(t.attr=g.mergeAttr({style:"width:"+t.width},t.attr)),t.required&&(t.attr.required="required"),$.each(t.attr,function(t,e){i.push(t+'="'+e+'"')}),ejs.render(f["fields/textarea.html"],{field:t,value:null!==this._value?this._value:"",render:{attr:0<i.length?" "+i.join(" "):""}})}},o.fields.wysiwyg={_id:"",_hash:"",_form:null,_value:null,_editor:null,_editorHash:null,_options:{type:"wysiwyg",label:null,labelWidth:null,width:null,minWidth:null,maxWidth:null,height:null,minHeight:null,maxHeight:null,options:{},outContent:null,description:null,required:null,readonly:!1,show:!0,column:null},init:function(t,e,i){this._form=t,this._index=i,this._id=t.getId()+"-field-"+(e.hasOwnProperty("name")?e.name:i),this._hash=g.hashCode(),this._editorHash=g.hashCode(),this._value=g.getFieldValue(t,e),this._options=g.mergeFieldOptions(t,this._options,e);var n=this;t.on("show",function(){n._options.readonly||n._initEvents()})},getOptions:function(){return $.extend(!0,{},this._options)},readonly:function(t){this._value=this.getValue(),this._options.readonly=!!t,$(".content-"+this._hash).html(this.renderContent()),this._options.readonly||this._initEvents()},hide:function(t){$("#coreui-form-"+this._id).hide(t||0)},show:function(t){$("#coreui-form-"+this._id).show(t||0)},getValue:function(){return!this._options.readonly&&this._editor?this._editor.getContent():this._value},setValue:function(t){this._value=t,this._options.readonly?$(".content-"+this._hash).text(t):this._editor&&this._editor.setContent(t)},validate:function(t,e){var i;this._options.readonly||((i=$(".content-"+this._hash)).find(".text-success").remove(),i.find(".text-danger").remove(),null!==t&&(t?"string"==typeof(e=void 0===e&&"string"==typeof this._options.validText?this._options.validText:e)&&i.append('<div class="ps-2 text-success">'+e+"</div>"):(void 0===e&&("string"==typeof this._options.invalidText?e=this._options.invalidText:!e&&this._options.required&&(e=this._form.getLang().required_field)),"string"==typeof e&&i.append('<div class="ps-2 text-danger">'+e+"</div>"))))},isValid:function(){return!(this._options.required&&!this._options.readonly&&!this.getValue())},render:function(){var t=this.getOptions(),e=g.getAttacheFields(this._form,t);return ejs.render(f["form-field-label.html"],{id:this._id,form:this._form,hash:this._hash,field:t,content:this.renderContent(),attachFields:e})},renderContent:function(){var t=this.getOptions();return ejs.render(f["fields/wysiwyg.html"],{field:t,value:null!==this._value?this._value:"",editorHash:this._editorHash})},_initEvents:function(){var t,e,i;this._options.readonly||(i={},e="editor-"+(t=this)._editorHash,(i="object"===c(this._options.options)&&!Array.isArray(this._options.options)&&0<Object.keys(this._options.options).length?this._options.options:"simple"===this._options.options?{plugins:"image lists anchor charmap",toolbar:"blocks | bold italic underline | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | forecolor backcolor removeformat",menubar:!1,branding:!1}:{promotion:!1,branding:!1,plugins:"preview importcss searchreplace autolink autosave save directionality code visualblocks visualchars fullscreen image link media template codesample table charmap pagebreak nonbreaking anchor insertdatetime advlist lists wordcount help charmap quickbars emoticons",menubar:"file edit view insert format tools table help",toolbar:"undo redo | bold italic underline strikethrough | fontfamily fontsize blocks | alignleft aligncenter alignright alignjustify | outdent indent | numlist bullist | forecolor backcolor removeformat | pagebreak | charmap emoticons | fullscreen preview save print | insertfile image media template link anchor codesample | ltr rtl"}).selector="#editor-"+this._editorHash,0<=["string","number"].indexOf(c(this._options.width))&&(i.width=this._options.width),0<=["string","number"].indexOf(c(this._options.minWidth))&&(i.min_width=this._options.minWidth),0<=["string","number"].indexOf(c(this._options.maxWidth))&&(i.max_width=this._options.maxWidth),0<=["string","number"].indexOf(c(this._options.height))&&(i.height=this._options.height),0<=["string","number"].indexOf(c(this._options.minHeight))&&(i.min_height=this._options.minHeight),0<=["string","number"].indexOf(c(this._options.maxHeight))&&(i.max_height=this._options.maxHeight),tinymce.init(i).then(function(){t._editor=tinymce.get(e)}))}},o.fields.passwordRepeat={_id:"",_hash:"",_form:null,_index:0,_isChangeState:!0,_value:"",_options:{type:"password_repeat",name:null,label:null,labelWidth:null,width:null,outContent:null,description:null,errorText:null,attach:null,attr:{type:"password",class:"form-control d-inline-block flex-shrink-0"},required:null,invalidText:null,validText:null,readonly:null,show:!0,showBtn:!0,column:null},init:function(t,e,i){this._form=t,this._index=i,this._id=t.getId()+"-field-"+(e.hasOwnProperty("name")?e.name:i),this._hash=g.hashCode(),this._value=g.getFieldValue(t,e),this._options=g.mergeFieldOptions(t,this._options,e);var n=this;t.on("show",function(){n._initEvents()})},getOptions:function(){return $.extend(!0,{},this._options)},readonly:function(t){this._value=this.getValue(),this._options.readonly=!!t,$(".content-"+this._hash).html(this.renderContent()),this._options.readonly||this._initEvents()},hide:function(t){$("#coreui-form-"+this._id).hide(t)},show:function(t){$("#coreui-form-"+this._id).show(t)},getValue:function(){var t;return this._options.readonly?this._value:void 0!==(t=$(".content-"+this._hash+' input[type="password"]').eq(0)).attr("disabled")&&!1!==t.attr("disabled")?null:t.val()},setValue:function(t){["string","number"].indexOf(c(t))<0||(this._value=t,this._options.readonly?$(".content-"+this._hash).text(t?"******":""):$(".content-"+this._hash+' input[type="password"]').val(t))},validate:function(t,e){var i,n;this._options.readonly||(i=$(".content-"+this._hash),n=$('input[type="password"]',i),i.find(".valid-feedback").remove(),i.find(".invalid-feedback").remove(),null===t?(n.removeClass("is-invalid"),n.removeClass("is-valid")):t?(n.removeClass("is-invalid"),n.addClass("is-valid"),"string"==typeof(e=void 0===e&&"string"==typeof this._options.validText?this._options.validText:e)&&i.append('<div class="valid-feedback d-block">'+e+"</div>")):(n.removeClass("is-valid"),n.addClass("is-invalid"),void 0===e&&("string"==typeof this._options.invalidText?e=this._options.invalidText:!e&&this._options.required&&(e=this._form.getLang().required_field)),"string"==typeof e&&i.append('<div class="invalid-feedback d-block">'+e+"</div>")))},isValid:function(){var t;return!(this._isChangeState&&!this._options.readonly)||(t=$(".content-"+this._hash+' input[type="password"]')).eq(0).val()===t.eq(1).val()&&(t[0]?t.eq(0).is(":valid"):null)},render:function(){var t=this.getOptions(),e=g.getAttacheFields(this._form,t);return ejs.render(f["form-field-label.html"],{id:this._id,form:this._form,hash:this._hash,field:t,content:this.renderContent(),attachFields:e})},renderContent:function(){return this._options.readonly?this._renderContentReadonly():this._renderContent()},_renderContent:function(){var i=[],n=[],t=this.getOptions(),e=(this._isChangeState=!t.showBtn||!this._value,t.hasOwnProperty("attr")&&"object"===c(t.attr)&&null!==t.attr&&!Array.isArray(t.attr)||(t.attr={}),this._isChangeState||(t.attr.disabled=""),t.name&&(t.attr.name=this._options.name),t.attr.value=this._value?"******":"",t.width&&(t.attr=g.mergeAttr({style:"width:"+t.width},t.attr)),t.required&&(t.attr.required="required"),$.each(t.attr,function(t,e){i.push(t+'="'+e+'"')}),$.each(t.attr,function(t,e){["name","value"].indexOf(t)<0&&n.push(t+'="'+e+'"')}),this._form.getLang());return ejs.render(f["fields/passwordRepeat.html"],{field:t,value:null!==this._value?this._value:"",lang:e,btn_text:this._isChangeState?e.cancel:e.change,render:{attr:0<i.length?" "+i.join(" "):"",attr2:0<n.length?" "+n.join(" "):""}})},_renderContentReadonly:function(){var t=this.getOptions();return ejs.render(f["fields/passwordRepeat.html"],{field:t,value:this._value?"******":"",hash:this._hash})},_initEvents:function(){var n=this;$(".content-"+this._hash+" .btn-password-change").click(function(t){var e=$(this).data("change"),i=$(this).data("cancel");n._isChangeState?($(".content-"+n._hash+' [type="password"]').attr("disabled","disabled"),$(this).text(e),n._isChangeState=!1):($(".content-"+n._hash+' [type="password"]').removeAttr("disabled"),$(this).text(i),n._isChangeState=!0)})}},o.fields.file={_id:"",_hash:"",_form:null,_index:0,_value:"",_options:{type:"file",name:null,label:null,labelWidth:null,width:null,outContent:null,description:null,errorText:null,attach:null,attr:{class:"form-control d-inline-block"},required:null,invalidText:null,validText:null,readonly:null,show:!0,column:null},init:function(t,e,i){this._form=t,this._index=i,this._id=t.getId()+"-field-"+(e.hasOwnProperty("name")?e.name:i),this._hash=g.hashCode(),this._value=g.getFieldValue(t,e),this._options=g.mergeFieldOptions(t,this._options,e)},getOptions:function(){return $.extend(!0,{},this._options)},readonly:function(t){this._value=this.getValue(),this._options.readonly=!!t,$(".content-"+this._hash).html(this.renderContent())},hide:function(t){$("#coreui-form-"+this._id).hide(t)},show:function(t){$("#coreui-form-"+this._id).show(t)},getValue:function(){return this._options.readonly?this._value:$(".content-"+this._hash+" input")[0].files},setValue:function(i){var n;(i instanceof File||i instanceof FileList)&&(this._value=i,this._options.readonly?$(".content-"+this._hash).text(""):(n=new DataTransfer,i instanceof File?n.items.add(i):$.each(i,function(t,e){i instanceof File&&n.items.add(e)}),$(".content-"+this._hash+" input")[0].files=n.files))},validate:function(t,e){var i,n;this._options.readonly||(i=$(".content-"+this._hash),n=$("input",i),i.find(".valid-feedback").remove(),i.find(".invalid-feedback").remove(),null===t?(n.removeClass("is-invalid"),n.removeClass("is-valid")):t?(n.removeClass("is-invalid"),n.addClass("is-valid"),"string"==typeof(e=void 0===e&&"string"==typeof this._options.validText?this._options.validText:e)&&i.append('<div class="valid-feedback">'+e+"</div>")):(n.removeClass("is-valid"),n.addClass("is-invalid"),void 0===e&&("string"==typeof this._options.invalidText?e=this._options.invalidText:!e&&this._options.required&&(e=this._form.getLang().required_field)),"string"==typeof e&&i.append('<div class="invalid-feedback">'+e+"</div>")))},isValid:function(){var t=$(".content-"+this._hash+" input");return t[0]?t.is(":valid"):null},render:function(){var t=this.getOptions(),e=g.getAttacheFields(this._form,t);return ejs.render(f["form-field-label.html"],{id:this._id,form:this._form,hash:this._hash,field:t,content:this.renderContent(),attachFields:e})},renderContent:function(){return this._options.readonly?this._renderContentReadonly():this._renderContent()},_renderContent:function(){var i=[],t=this.getOptions();return t.hasOwnProperty("attr")&&"object"===c(t.attr)&&null!==t.attr&&!Array.isArray(t.attr)||(t.attr={}),t.name&&(t.attr.name=this._options.name),t.attr.type=t.type,t.attr.value=null!==this._value?this._value:"",t.width&&(t.attr=g.mergeAttr({style:"width:"+t.width},t.attr)),t.required&&(t.attr.required="required"),$.each(t.attr,function(t,e){i.push(t+'="'+e+'"')}),ejs.render(f["fields/input.html"],{field:t,datalistId:"",value:null!==this._value?this._value:"",render:{attr:0<i.length?" "+i.join(" "):"",datalist:[]}})},_renderContentReadonly:function(){var t=this.getOptions(),e="text",i=this._value,n=this._form.getLang();t.hasOwnProperty("type")&&"string"==typeof t.type&&(e=t.type);try{switch(e){case"date":i=g.formatDate(i);break;case"datetime-local":i=g.formatDateTime(i);break;case"month":i=g.formatDateMonth(i,n);break;case"week":i=g.formatDateWeek(i,n)}}catch(t){console.error(t)}return ejs.render(f["fields/input.html"],{field:t,value:i,hash:this._hash})}};let u={isObject:function(t){return"object"==typeof t&&!Array.isArray(t)&&null!==t},isNumeric:function(t){return("number"==typeof t||"string"==typeof t&&""!==t.trim())&&!isNaN(t)},getFileSize:function(t){return t instanceof File?t.size||t.fileSize:null},getFileName:function(t){return t instanceof File?t.name||t.fileName:null},getSizeHuman:function(t){if(!u.isNumeric(t))return"";let e="";return 1073741824<=(t=Number(t))?e=(t/1073741824).toFixed(2)+" Gb":1048576<=t?e=(t/1048576).toFixed(2)+" Mb":1024<=t?e=(t/1024).toFixed(2)+" Kb":0<=t&&(e=t+" bytes"),e},hashCode:function(){return this.crc32(((new Date).getTime()+Math.random()).toString()).toString(16)},crc32:function(t){for(var e=[],i=0;i<256;i++){for(var n=i,o=0;o<8;o++)n=1&n?3988292384^n>>>1:n>>>1;e[i]=n}for(var s=-1,r=0;r<t.length;r++)s=s>>>8^e[255&(s^t.charCodeAt(r))];return(-1^s)>>>0}},s={onLoadStart:function(t){t=t.getElement();t&&(t.find(".fileup-upload").hide(),t.find(".fileup-abort").show(),t.find(".fileup-result").removeClass("fileup-error").removeClass("fileup-success").text(""))},onLoadProgress:function(t,e){e.lengthComputable&&(e=Math.ceil(e.loaded/e.total*100),t=t.getElement())&&t.find(".fileup-progress-bar").css("width",e+"%")},onLoadAbort:function(t){t=t.getElement();t&&(t.find(".fileup-abort").hide(),t.find(".fileup-upload").show(),t.find(".fileup-result").removeClass("fileup-error").removeClass("fileup-success").text(""))},onSuccess:function(t){var e,t=t.getElement();t&&(e=this.getLang(),t.find(".fileup-abort").hide(),t.find(".fileup-upload").hide(),t.find(".fileup-result").removeClass("fileup-error").addClass("fileup-success").text(e.complete))},onError:function(e,i){var n=this.getLang();switch(e){case"files_limit":alert(n.errorFilesLimit.replace(/%filesLimit%/g,i.filesLimit));break;case"size_limit":var o=u.getSizeHuman(i.sizeLimit);let t=n.errorSizeLimit;t=(t=t.replace(/%sizeLimit%/g,o)).replace(/%fileName%/g,u.getFileName(i.fileData)),alert(t);break;case"file_type":alert(n.errorFileType.replace(/%fileName%/g,u.getFileName(i.fileData)));break;case"load_bad_status":case"load_error":case"load_timeout":var s,o=i.file.getElement();o&&(s="load_bad_status"===e?n.errorBadStatus:n.errorLoad,o.find(".fileup-abort").hide(),o.find(".fileup-upload").show(),o.find(".fileup-result").addClass("fileup-error").text(s));break;case"old_browser":alert(n.errorOldBrowser)}},onDragOver:function(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy";t=this.getDropzone();t&&t.addClass("over")},onDragLeave:function(t){var e=this.getDropzone();e&&e.removeClass("over")},onDragEnd:function(t){var e=this.getDropzone();e&&e.removeClass("over")},onDragEnter:function(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"}},r={initInput:function(t){let e=null;if(t._options.input instanceof HTMLElement||t._options.input instanceof jQuery?e=$(t._options.input):"string"==typeof t._options.input&&t._options.input&&(e=$("#"+t._options.input)),!e||!$(e)[0]||"file"!==$(e)[0].type)throw new Error("Not found input element");t._input=e},initQueue:function(t){let e=null;if(t._options.queue instanceof HTMLElement||t._options.queue instanceof jQuery?e=$(t._options.queue):"string"==typeof t._options.queue&&t._options.queue&&(e=$("#"+t._options.queue)),!e||!$(e)[0])throw new Error("Not found queue element");t._queue=e},initDropzone:function(i){let t=null;if(i._options.dropzone instanceof HTMLElement||i._options.dropzone instanceof jQuery?t=$(i._options.dropzone):"string"==typeof i._options.dropzone&&i._options.dropzone&&(t=$("#"+i._options.dropzone)),t){i._dropzone=t;let e=this;t.on("click",function(){i.getInput().click()}),t[0].addEventListener("dragover",function(t){e.trigger(i,"drag_over",[t])}),t[0].addEventListener("dragleave",function(t){e.trigger(i,"drag_leave",[t])}),t[0].addEventListener("dragenter",function(t){e.trigger(i,"drag_enter",[t])}),t[0].addEventListener("dragend",function(t){e.trigger(i,"drag_end",[t])}),t[0].addEventListener("drop",function(t){i.getInput()[0].files=t.target.files||t.dataTransfer.files,e.appendFiles(i,t)})}},initEvents:function(n){function t(t,e){let i=null;"function"==typeof e?i=e:"string"==typeof e&&(i=new Function(e)),i&&n.on(t,i)}var e=n.getOptions();let i=this;t("load_start",s.onLoadStart),t("load_progress",s.onLoadProgress),t("load_abort",s.onLoadAbort),t("load_success",s.onSuccess),t("error",s.onError),t("drag_over",s.onDragOver),t("drag_leave",s.onDragEnter),t("drag_end",s.onDragLeave),t("drag_enter",s.onDragEnd),e.onSelect&&t("select",e.onSelect),e.onRemove&&t("remove",e.onRemove),e.onBeforeStart&&t("load_before_start",e.onBeforeStart),e.onStart&&t("load_start",e.onStart),e.onProgress&&t("load_progress",e.onProgress),e.onAbort&&t("load_abort",e.onAbort),e.onSuccess&&t("load_success",e.onSuccess),e.onFinish&&t("load_finish",e.onFinish),e.onError&&t("error",e.onError),e.onDragOver&&t("drag_over",e.onDragOver),e.onDragLeave&&t("drag_leave",e.onDragLeave),e.onDragEnd&&t("drag_end",e.onDragEnd),e.onDragEnter&&t("drag_enter",e.onDragEnter),n.getInput().on("change",function(t){i.appendFiles(n,t)})},renderFiles:function(t){var e=t.getOptions();if(Array.isArray(e.files)&&0<e.files.length)for(var i=0;i<e.files.length;i++)u.isObject(e.files[i])&&t.appendFileByData(e.files[i])},trigger:function(t,e,i){i=i||[];var n=[];if(t._events[e]instanceof Object&&0<t._events[e].length)for(var o=0;o<t._events[e].length;o++){var s=t._events[e][o].callback;n.push(s.apply(t._events[e][o].context||t,i)),t._events[e][o].singleExec&&(t._events[e].splice(o,1),o--)}return n},appendFiles:function(e,t){t.preventDefault(),t.stopPropagation();var i=e.getOptions(),n=e.getInput(),o=n[0].files,s=n.is("[multiple]");if(0<o.length){for(var r=0;r<o.length;r++){var a=o[r];if(0<i.sizeLimit&&u.getFileSize(a)>i.sizeLimit)this.trigger(e,"error",["size_limit",{fileData:a,sizeLimit:i.sizeLimit}]);else{if(0<i.filesLimit&&Object.keys(e._files).length>=i.filesLimit){this.trigger(e,"error",["files_limit",{fileData:a,filesLimit:i.filesLimit}]);break}if("string"==typeof n[0].accept){var l=n[0].accept;if(l&&/[^\w]+/.test(l)){let t=!1;var d=l.split(",");if(0<d.length)for(var h=0;h<d.length;h++)if(d[h]=d[h].replace(/\s/g,""),new RegExp(d[h].replace("*",".*")).test(a.type)||new RegExp(d[h].replace(".",".*/")).test(a.type)){t=!0;break}if(!t){this.trigger(e,"error",["file_type",{fileData:a}]);continue}}}l=this.trigger(e,"select",[a]);if(l){let i=!1;if($.each(l,function(t,e){if(!1===e)return!(i=!0)}),i)continue}if(s||e.removeAll(),e.appendFile(a),!s)break}}n.val("")}this.trigger(e,"dragEnd",[t])}},a={_options:{name:null,size:null,urlPreview:null,urlDownload:null},_id:"",_status:"stand_by",_fileElement:null,_file:null,_fileUp:null,_xhr:null,_init:function(i,t,e,n){if(!u.isObject(e))throw new Error("File incorrect options param");if("number"!=typeof t||t<0)throw new Error("File dont set or incorrect id param");if("string"!=typeof e.name||!e.name)throw new Error("File dont set name param");if(this._fileUp=i,this._options=$.extend(!0,{},this._options,e),this._id=t,n instanceof File){let e=null;if(window.XMLHttpRequest)e=new("onload"in new XMLHttpRequest?XMLHttpRequest:XDomainRequest);else if(window.ActiveXObject)try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){r.trigger(i,"error",["old_browser",{file:this}])}}else r.trigger(i,"error",["old_browser",{file:this}]);if(!e)throw new Error("xhr dont created. Check your browser");this._xhr=e,this._file=n}else this._status="finish"},getId:function(){return this._id},getName:function(){return this._file?u.getFileName(this._file):this._options.name},getElement:function(){return this._fileElement},getUrlPreview:function(){return this._options.urlPreview},getUrlDownload:function(){return this._options.urlDownload},getSize:function(){return this._file?u.getFileSize(this._file):this._options.size},getSizeHuman:function(){var t=this.getSize();return u.getSizeHuman(t)},getXhr:function(){return this._xhr},getFile:function(){return this._file instanceof File?this._file:null},getStatus:function(){return this._status},setStatus:function(t){"string"==typeof t&&(this._status=t)},getOptions:function(){return this._options},getOption:function(t){return"string"==typeof t&&this._options.hasOwnProperty(t)?this._options[t]:null},setOption:function(t,e){"string"==typeof t&&(this._options[t]=e)},showError:function(t){var e;"string"==typeof t&&(e=this.getElement())&&e.find(".fileup-result").removeClass("fileup-success").addClass("fileup-error").text(t)},showSuccess:function(t){var e;"string"==typeof t&&(e=this.getElement())&&e.find(".fileup-result").removeClass("fileup-error").addClass("fileup-success").text(t)},remove:function(){this.abort(),this._fileElement&&this._fileElement.fadeOut("fast",function(){this.remove()});var t=this.getId();this._fileUp._files.hasOwnProperty(t)&&delete this._fileUp._files[t],r.trigger(this._fileUp,"remove",[this])},upload:function(){let e=this.getFile(),t=this.getXhr();if(!e||!t)return!1;var n=this._fileUp.getOptions();let i=this;if("number"==typeof n.timeout&&(t.timeout=n.timeout),t.onloadstart=function(){i.setStatus("load_start"),r.trigger(i._fileUp,"load_start",[i])},t.upload.onprogress=function(t){r.trigger(i._fileUp,"load_progress",[i,t])},t.onload=function(){i.setStatus("loaded"),200===t.status?r.trigger(i._fileUp,"load_success",[i,t.responseText]):r.trigger(i._fileUp,"error",["load_bad_status",{file:i,fileData:e,response:t.responseText,xhr:t}])},t.onloadend=function(){i.setStatus("finish"),r.trigger(i._fileUp,"load_finish",[i])},t.onabort=function(){i.setStatus("stand_by"),r.trigger(i._fileUp,"load_abort",[i])},t.ontimeout=function(){i.setStatus("stand_by"),r.trigger(i._fileUp,"error",["load_timeout",{file:i,fileData:e}])},t.onerror=function(t){i.setStatus("stand_by"),r.trigger(i._fileUp,"error",["load_error",{file:i,fileData:e,event:t}])},t.open(n.httpMethod||"post",n.url,!0),t.setRequestHeader("Cache-Control","no-cache"),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.trigger(i._fileUp,"load_before_start",[i,t]),void 0===window.FormData)return t.send(e);{let i=new FormData;return i.append(n.fieldName,e),Object.keys(n.extraFields).length&&$.each(n.extraFields,function(t,e){i.append(t,e)}),t.send(i)}},abort:function(){this._xhr&&this._xhr.abort()},render:function(t){if(!t||"string"!=typeof t)return null;var e=this._fileUp.getLang(),i=this._fileUp.getOptions();let n=this,o=!1;var s=u.isObject(i.mimeTypes)?i.mimeTypes:{},r="string"==typeof i.iconDefault?i.iconDefault:"",i="boolean"!=typeof i.showRemove||i.showRemove,a=this.getSizeHuman();let l=null,d=null,h=null;return t=(t=(t=(t=(t=t.replace(/\[NAME\]/g,this.getName())).replace(/\[SIZE\]/g,a)).replace(/\[UPLOAD\]/g,e.upload)).replace(/\[REMOVE\]/g,e.remove)).replace(/\[ABORT\]/g,e.abort),this._file&&this._file instanceof File?this._file.type&&"string"==typeof this._file.type&&this._file.type.match(/^image\/.*/)?("undefined"!=typeof FileReader&&((e=new FileReader).onload=function(t){n._fileElement&&n._fileElement.find(".fileup-preview").removeClass("no-preview").find("img").attr("src",t.target.result)},e.readAsDataURL(this._file)),o=!0,t=(t=t.replace(/\[PREVIEW_SRC\]/g,"")).replace(/\[TYPE\]/g,"fileup-image fileup-no-preview")):(t=(t=t.replace(/\[PREVIEW_SRC\]/g,"")).replace(/\[TYPE\]/g,"fileup-doc"),d=this._file.type,h=this.getName().split(".").pop()):(e=this.getUrlPreview(),t=(t=t.replace(/\[PREVIEW_SRC\]/g,e||"")).replace(/\[TYPE\]/g,e?"fileup-image":"fileup-doc"),h=this.getName()?this.getName().split(".").pop().toLowerCase():""),this._fileElement=$(t),o&&this._fileElement.find(".fileup-preview").addClass("no-preview"),a||this._fileElement.find(".fileup-size").hide(),(d||h)&&$.each(s,function(t,i){if(u.isObject(i)&&i.hasOwnProperty("icon")&&"string"==typeof i.icon&&""!==i.icon){if(d&&i.hasOwnProperty("mime"))if("string"==typeof i.mime){if(i.mime===d)return l=i.icon,!1}else if(Array.isArray(i.mime)){if($.each(i.mime,function(t,e){if("string"==typeof e&&e===d)return l=i.icon,!1}),l)return!1}else if(i.mime instanceof RegExp&&i.mime.test(d))return l=i.icon,!1;return!(h&&i.hasOwnProperty("ext")&&Array.isArray(i.ext)&&($.each(i.ext,function(t,e){if("string"==typeof e&&e===h)return l=i.icon,!1}),l))&&void 0}}),l=l||r,this._fileElement.find(".fileup-icon").addClass(l),i||this._fileElement.find(".fileup-remove").hide(),this.getUrlDownload()&&(e=this._fileElement.find(".fileup-name"))[0]&&e.replaceWith('<a href="'+this.getUrlDownload()+'" class="fileup-name" download="'+this.getName()+'">'+this.getName()+"</a>"),"finish"===this._status?(this._fileElement.find(".fileup-upload").hide(),this._fileElement.find(".fileup-abort").hide(),this._fileElement.find(".fileup-progress").hide()):(this._fileElement.find(".fileup-upload").click(function(){n.upload()}),this._fileElement.find(".fileup-abort").click(function(){n.abort()})),this._fileElement.find(".fileup-remove").click(function(){n.remove()}),this._fileElement}},l=Object.create(null),d={_options:{id:null,url:null,input:null,queue:null,dropzone:null,files:[],fieldName:"file",extraFields:{},lang:"en",langItems:null,sizeLimit:0,filesLimit:0,httpMethod:"post",timeout:null,autostart:!(l["file.html"]='<div class="fileup-file [TYPE] mb-2 p-1 d-flex flex-nowrap gap-2 bg-light border border-secondary-subtle rounded rounded-1"> <div class="fileup-preview"> <img src="[PREVIEW_SRC]" alt="[NAME]" class="border rounded"/> <i class="fileup-icon fs-4 text-secondary"></i> </div> <div class="flex-fill"> <div class="fileup-description"> <span class="fileup-name">[NAME]</span> <small class="fileup-size text-nowrap text-secondary">([SIZE])</small> </div> <div class="fileup-controls mt-1 d-flex gap-2"> <span class="fileup-remove" title="[REMOVE]">✕</span> <span class="fileup-upload link-primary">[UPLOAD]</span> <span class="fileup-abort link-primary" style="display:none">[ABORT]</span> </div> <div class="fileup-result"></div> <div class="fileup-progress progress mt-2 mb-1"> <div class="fileup-progress-bar progress-bar"></div> </div> </div> </div>'),showRemove:!0,templateFile:null,onSelect:null,onRemove:null,onBeforeStart:null,onStart:null,onProgress:null,onAbort:null,onSuccess:null,onFinish:null,onError:null,onDragOver:null,onDragLeave:null,onDragEnd:null,onDragEnter:null,iconDefault:"bi bi-file-earmark-text",mimeTypes:{archive:{mime:["application/zip","application/gzip","application/x-bzip","application/x-bzip2","application/x-7z-compressed"],ext:["zip","7z","bz","bz2","gz","jar","rar","tar"],icon:"bi bi-file-earmark-zip"},word:{mime:["application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],ext:["doc","docx"],icon:"bi bi-file-earmark-word"},excel:{mime:["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],ext:["xls","xlsx"],icon:"bi bi-file-earmark-excel"},image:{mime:/image\/.*/,ext:["jpg","jpeg","png","bmp","gif","raw","webp","heic","ico"],icon:"bi bi-file-earmark-image"},video:{mime:/video\/.*/,ext:["avi","mp4","mpeg","ogv","ts","webm","3gp","3g2","mkv"],icon:"bi bi-file-earmark-play"},audio:{mime:/audio\/.*/,ext:["avi","mp4","mpeg","ogv","ts","webm","3gp","3g2","mkv"],icon:"bi bi-file-earmark-music"},pdf:{mime:["application/pdf"],ext:["pdf"],icon:"bi bi-file-earmark-pdf"},binary:{mime:["application/octet-stream"],ext:["bin","exe","dat","dll"],icon:"bi bi-file-earmark-binary"}}},_id:null,_fileUp:null,_fileIndex:0,_input:null,_queue:null,_dropzone:null,_files:{},_events:{},_init:function(t,e){if("string"!=typeof e.url||!e.url)throw new Error("Dont set url param");this._fileUp=t,this._options=$.extend(!0,{},this._options,e),this._id="string"==typeof this._options.id&&this._options.id?this._options.id:u.hashCode(),this._options.templateFile&&"string"==typeof this._options.templateFile||(this._options.templateFile=l["file.html"]),r.initInput(this),r.initQueue(this),r.initDropzone(this),r.initEvents(this),r.renderFiles(this)},destruct:function(){var t=this.getId();this._fileUp._instances.hasOwnProperty(t)&&delete this._fileUp._instances[t]},getOptions:function(){return this._options},getId:function(){return this._id},getInput:function(){return this._input},getQueue:function(){return this._queue},getDropzone:function(){return this._dropzone},on:function(t,e,i){"object"!=typeof this._events[t]&&(this._events[t]=[]),this._events[t].push({context:i||this,callback:e,singleExec:!1})},one:function(t,e,i){"object"!=typeof this._events[t]&&(this._events[t]=[]),this._events[t].push({context:i||this,callback:e,singleExec:!0})},getLang:function(){return $.extend(!0,{},this._options.langItems)},getFiles:function(){return this._files},getFileById:function(i){let n=null;return $.each(this._files,function(t,e){i===e.getId()&&(n=e)}),n},removeAll:function(){$.each(this._files,function(t,e){e.remove()})},uploadAll:function(){$.each(this._files,function(t,e){e.upload()})},abortAll:function(){$.each(this._files,function(t,e){e.abort()})},appendFile:function(t){var e,i;return t instanceof File&&(e=$.extend(!0,{},a),i={name:u.getFileName(t),size:u.getFileSize(t),type:t.type},e._init(this,this._fileIndex,i,t),this._files[this._fileIndex]=e,(i=this.getQueue())&&i.append(e.render(this._options.templateFile)),this._fileIndex++,"boolean"==typeof this._options.autostart&&this._options.autostart&&e.upload(),!0)},appendFileByData:function(t){var e;return!!u.isObject(t)&&((e=$.extend(!0,{},a))._init(this,this._fileIndex,t),e.setStatus("finish"),this._files[this._fileIndex]=e,(t=this.getQueue())&&t.append(e.render(this._options.templateFile)),this._fileIndex++,!0)}},h={lang:{},_instances:{},create:function(t){(t=u.isObject(t)?t:{}).hasOwnProperty("lang")||(t.lang="en");var e=this.lang.hasOwnProperty(t.lang)?this.lang[t.lang]:{},e=(t.langItems=t.hasOwnProperty("langItems")&&u.isObject(t.langItems)?$.extend(!0,{},e,t.langItems):e,$.extend(!0,{},d)),t=(e._init(this,t),e.getId());return this._instances[t]=e},get:function(t){return this._instances.hasOwnProperty(t)?$.contains(document,this._instances[t]._input[0])?this._instances[t]:(delete this._instances[t],null):null}};return h.lang.en={upload:"Upload",abort:"Abort",remove:"Remove",complete:"Complete",error:"Error",errorLoad:"Error uploading file",errorBadStatus:"Error uploading file. Bad request.",errorFilesLimit:"The number of selected files exceeds the limit (%filesLimit%)",errorSizeLimit:'File "%fileName%" exceeds the size limit (%sizeLimit%)',errorFileType:'File "%fileName%" is incorrect',errorOldBrowser:"Your browser can not upload files. Update to the latest version"},h.lang.ru={upload:"Загрузить",abort:"Остановить",remove:"Удалить",complete:"Готово",error:"Ошибка",errorLoad:"Ошибка при загрузке файла",errorBadStatus:"Ошибка при загрузке файла. Некорректный запрос.",errorFilesLimit:"Количество выбранных файлов превышает лимит (%filesLimit%)",errorSizeLimit:'Файл "%fileName%" превышает предельный размер (%sizeLimit%)',errorFileType:'Файл "%fileName%" является некорректным',errorOldBrowser:"Обновите ваш браузер до последней версии"},h.lang.es={upload:"Subir",abort:"Cancelar",remove:"Eliminar",complete:"Cargado",error:"Error",errorLoad:"Error al cargar el archivo",errorBadStatus:"Error al cargar el archivo. Solicitud no válida.",errorFilesLimit:"El número de archivo selecccionados excede el límite (%filesLimit%)",errorSizeLimit:'El archivo "%fileName%" excede el limite de tamaño (%sizeLimit%)',errorFileType:'El archivo "%fileName%" es inválido',errorOldBrowser:"Tu navegador no puede subir archivos. Actualiza a la última versión"},h.lang.pt={upload:"Enviar",abort:"Cancelar",remove:"Remover",complete:"Enviado",error:"Erro",errorLoad:"Erro ao carregar o arquivo",errorBadStatus:"Erro ao carregar o arquivo. Pedido inválido.",errorFilesLimit:"O número de arquivos selecionados excede o limite (%filesLimit%)",errorSizeLimit:'Arquivo "%fileName%" excede o limite (%sizeLimit%)',errorFileType:'Arquivo "%fileName%" inválido',errorOldBrowser:"Seu navegador não pode enviar os arquivos. Atualize para a versão mais recente"},o.fields.fileUpload={_id:"",_hash:"",_form:null,_index:0,_value:null,_fileUp:null,_options:{type:"fileUpload",name:null,label:null,labelWidth:null,width:null,outContent:null,description:null,errorText:null,attach:null,required:null,invalidText:null,validText:null,readonly:null,show:!0,column:null,options:{url:"",httpMethod:"post",fieldName:"file",showButton:!0,showDropzone:!1,autostart:!0,accept:null,timeout:null,filesLimit:null,sizeLimit:null,templateFile:null}},init:function(t,e,i){this._form=t,this._index=i,this._id=t.getId()+"-field-"+(e.hasOwnProperty("name")?e.name:i),this._hash=g.hashCode(),this._value=g.getFieldValue(t,e),this._options=g.mergeFieldOptions(t,this._options,e);var n=this;t.on("show",function(){n._initEvents()})},getOptions:function(){return $.extend(!0,{},this._options)},readonly:function(t){this._value=this._getFiles(),this._options.readonly=!!t,this._fileUp&&this._fileUp.destruct(),$(".content-"+this._hash).html(this.renderContent()),this._initEvents()},hide:function(t){$("#coreui-form-"+this._id).hide(t)},show:function(t){$("#coreui-form-"+this._id).show(t)},getValue:function(){var t=this._getFiles();return $.each(t,function(t,e){e.hasOwnProperty("urlPreview")&&delete e.urlPreview,e.hasOwnProperty("urlDownload")&&delete e.urlDownload}),t},setValue:function(t){var i;Array.isArray(t)&&((i=this)._fileUp.removeAll(),$.each(t,function(t,e){e instanceof File?i._fileUp.appendFile(e):g.isObject(e)&&i._fileUp.appendFileByData(e)}))},validate:function(t,e){var i;this._options.readonly||((i=$(".content-"+this._hash)).find("> .validate-content").remove(),t?"string"==typeof(e=void 0===e&&"string"==typeof this._options.validText?this._options.validText:e)&&i.append('<div class="validate-content text-success">'+e+"</div>"):!1===t&&(void 0===e&&("string"==typeof this._options.invalidText?e=this._options.invalidText:!e&&this._options.required&&(e=this._form.getLang().required_field)),"string"==typeof e)&&i.append('<div class="validate-content text-danger">'+e+"</div>"))},isValid:function(){return this._options.required&&this._fileUp?0<this._getFiles().length:null},getFileUp:function(){return this._fileUp},render:function(){var t=this.getOptions(),e=g.getAttacheFields(this._form,t);return ejs.render(f["form-field-label.html"],{id:this._id,form:this._form,hash:this._hash,field:t,content:this.renderContent(),attachFields:e})},renderContent:function(){return this._options.readonly?this._renderContentReadonly():this._renderContent()},_renderContent:function(){var t=this._form.getLang(),e=g.isObject(this._options.options)?this._options.options:{},i=!(g.isNumeric(e.filesLimit)&&1===Number(e.filesLimit)),n="string"==typeof e.accept&&e.accept?e.accept:null;return ejs.render(f["fields/file-upload.html"],{id:this._hash,showButton:!!e.showButton,showDropzone:!!e.showDropzone,isMultiple:i,accept:n,lang:t})},_renderContentReadonly:function(){var t=this._form.getLang(),e=g.isObject(this._options.options)?this._options.options:{},i=!(g.isNumeric(e.filesLimit)&&1===Number(e.filesLimit)),e="string"==typeof e.accept&&e.accept?e.accept:null;return ejs.render(f["fields/file-upload.html"],{id:this._hash,showButton:!1,showDropzone:!1,isMultiple:i,accept:e,lang:t})},_initEvents:function(){var t=g.isObject(this._options.options)?this._options.options:{},e=this._form.getOptions(),i=$("#fileup-"+this._hash+"-queue"),n={url:"string"==typeof t.url?t.url:"",input:"fileup-"+this._hash,queue:i};e.showDropzone&&(n.dropzone="fileup-"+this._hash+"-dropzone"),"string"==typeof e.lang&&(n.lang=e.lang),"string"==typeof t.fieldName&&(n.fieldName=t.fieldName),"string"==typeof t.httpMethod&&(n.httpMethod=t.httpMethod),g.isObject(t.extraFields)&&(n.extraFields=t.extraFields),g.isNumeric(t.sizeLimit)&&(n.sizeLimit=t.sizeLimit),g.isNumeric(t.filesLimit)&&(n.filesLimit=t.filesLimit),g.isNumeric(t.timeout)&&(n.timeout=t.timeout),"boolean"==typeof t.autostart&&(n.autostart=t.autostart),"string"==typeof t.templateFile&&(n.templateFile=t.templateFile),this._options.readonly&&(n.showRemove=!1),Array.isArray(this._value)&&(n.files=this._value),this._fileUp=h.create(n),Array.isArray(this._value)&&0<this._value.length&&i.addClass("mt-2"),this._fileUp.on("select",function(t){i.addClass("mt-2")}),this._fileUp.on("remove",function(t){0===Object.keys(this.getFiles()).length&&setTimeout(function(){i.removeClass("mt-2")},150)}),this._fileUp.on("load_success",function(e,t){var i=null;if(t)try{i=JSON.parse(t)}catch(t){e.showError("Incorrect response JSON format")}i&&e.setOption("upload",i)})},_getFiles:function(){var t,o;return this._fileUp?(t=this._fileUp.getFiles(),o=[],0<Object.keys(t).length&&$.each(t,function(t,e){var i=e.getFile(),n=e.getOptions();n.name=e.getName(),n.size=e.getSize(),i&&i instanceof File&&(n.type=i.type),o.push(n)}),o):[]}},o});
//# sourceMappingURL=coreui-form.min.js.map
